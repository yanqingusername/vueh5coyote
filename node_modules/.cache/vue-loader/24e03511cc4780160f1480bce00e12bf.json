{"remainingRequest":"/Users/user/coyote/vueh5coyote/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/user/coyote/vueh5coyote/src/pages/instrumentBind.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/user/coyote/vueh5coyote/src/pages/instrumentBind.vue","mtime":1648710525448},{"path":"/Users/user/coyote/vueh5coyote/node_modules/babel-loader/lib/index.js","mtime":1647851357560},{"path":"/Users/user/coyote/vueh5coyote/node_modules/cache-loader/dist/cjs.js","mtime":1647851357606},{"path":"/Users/user/coyote/vueh5coyote/node_modules/vue-loader/lib/index.js","mtime":1647851377631}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qKgogKiDms6g6IOatpOmhtemdouWPquS4uuenu+WKqOerr+acjeWKoSwg5ZyocGPmqKHlvI/kuIvkvJrlr7zoh7TpobXpnaLlpLHljrvmr5TkvosKICogaDXpobUKICovCgppbXBvcnQgSGVhZGVyIGZyb20gIi4uL2NvbXBvbmVudHMvaGVhZGVyLnZ1ZSI7CmltcG9ydCB7IHVkYXRlSDVJbWFnZXMsdXBsb2FkSW1nU2VsZWN0LHVwbG9hZEltZ0JpbmQgLGJpbmRpbnN0cnVtZW50LCBnZXRKU1NES0hFTFAsc2F2ZWluc3RydW1lbnQsZ2V0QmluZGJ1dG4sc2VhcmNoU059IGZyb20gIi4uL3JlcXVlc3QvYXBpIjsKLy8gaW1wb3J0IHsgTm90aWZ5IH0gZnJvbSAidmFudCI7CmltcG9ydCB7IEJ1dHRvbixEaWFsb2cgLFVwbG9hZGVyLFRvYXN0LEltYWdlUHJldmlldyxMb2FkaW5nfSBmcm9tICd2YW50JzsKaW1wb3J0IHd4IGZyb20gJ2p3ZWl4aW4tbW9kdWxlJzsKaW1wb3J0IERyb3BEb3duTGlzdCBmcm9tICIuLi9jb21wb25lbnRzL21nX3NlbGVjdC52dWUiOwoKdmFyIGltZ3VybDE9ICcnCnZhciBpbWd1cmw9ICcnCiB2YXIgaW1ndXJsMj0gJycKIHZhciBpbWd1cmwzPSAnJwogIHZhciBpbWd1cmw0PSAnJwogdmFyIGltZ3VybDU9ICcnCnZhciBpbWd1cmw2PSAnJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICIiLAogIGNvbXBvbmVudHM6IHsKICAgIEhlYWRlciwKICAgIFtEaWFsb2cuQ29tcG9uZW50Lm5hbWVdOiBEaWFsb2cuQ29tcG9uZW50LCAvL0RpYWxvZy5Db21wb25lbnTlhpnmiJDov5nmoLfmiY3nlJ/mlYgKICAgIFtCdXR0b24ubmFtZV06IEJ1dHRvbiwKICAgIFVwbG9hZGVyLAogICAgRHJvcERvd25MaXN0CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNTaG93SW5zdHJ1bWVudDogdHJ1ZSwKICAgICAgaW5zdHJ1bWVudExpc3Q6WwogICAgICAgIHsKICAgICAgICAgICdpbnN0cnVtZW50X25hbWUnOiAnbWluaTgnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAnaW5zdHJ1bWVudF9uYW1lJzogJ2ZsYXNoMjAnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAnaW5zdHJ1bWVudF9uYW1lJzogJ21pbmk4JwogICAgICAgIH0KICAgICAgXSwKICAgICAgaW5zdHJ1bWVudEluZGV4OiAtMSwKICAgICAgaW5zdHJ1bWVudF9uYW1lOiIiLAogICAgICByb2xlSWQ6IDEsICAvLyAxLS3lupPnrqEgICAyLS3nlJ/kuqcgIDMtLee7tOS/rgogICAgICBsYWJlbF9zbjogIiIsCiAgICAgIGNoYXNzaXNfc246ICIiLAogICAgICBpbnN0cnVtZW50X3NuOiAiIiwKICAgICAgbnVtMV9zbjogIiIsCiAgICAgIG51bTJfc246ICIiLAogICAgICBudW0zX3NuOiAiIiwKICAgICAgbnVtNF9zbjogIiIsCiAgICAgIG51bWJlckxpc3Q6IFtdLAogICAgICBsYWJsZUxlbmd0aDogMSwKICAgICAgaXNTaG93OiBmYWxzZSwKICAgICAgbGFiZWxJbmRleDogLTEsCiAgICAgIGltZ3VybDE6ICcnLAogICAgICBpbWd1cmw6ICcnLAogICAgICBpbWd1cmwyOiAnJywKICAgICAgaW1ndXJsMzogJycsCiAgICAgIGltZ3VybDQ6ICcnLAogICAgICBpbWd1cmw1OiAnJywKICAgICAgaW1ndXJsNjogJycsCiAgICAgIGxhYmVsX3NuX29sZDogJycsCiAgICAgIGNoYXNzaXNfc25fb2xkOiAnJywKICAgICAgaW5zdHJ1bWVudF9zbl9vbGQ6ICIiLAogICAgICBudW0xX3NuX29sZDogIiIsCiAgICAgIG51bTJfc25fb2xkOiAiIiwKICAgICAgbnVtM19zbl9vbGQ6ICIiLAogICAgICBudW00X3NuX29sZDogIiIsCiAgICAgIG51bWJlclR5cGU6ICIwIiwKICAgICAgaW1ndXJsMV9vbGQ6ICcnLAogICAgICBpbWd1cmxfb2xkOiAnJywKICAgICAgaW1ndXJsMl9vbGQ6ICcnLAogICAgICBpbWd1cmwzX29sZDogJycsCiAgICAgIGltZ3VybDRfb2xkOiAnJywKICAgICAgaW1ndXJsNV9vbGQ6ICcnLAogICAgICBpbWd1cmw2X29sZDogJycsCiAgICAgIGlzRWRpdDogZmFsc2UKICAgIH07CiAgfSwKICBhY3RpdmF0ZWQoKSB7CiAgICB0aGlzLnJvbGVJZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkOwogICAgY29uc29sZS5sb2codGhpcy5yb2xlSWQpCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pc1dlY2hhdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgb25JbnN0cnVtZW50Q2hhbmdlKHZhbCkgewogICAgICBsZXQgY29kZSA9IHZhbC52YWx1ZS5pbnN0cnVtZW50X25hbWU7CiAgICAgIGNvbnNvbGUubG9nKGNvZGUpCiAgICAgIHRoaXMuaW5zdHJ1bWVudF9uYW1lID0gY29kZTsKICAgIH0sCiAgICAvLyDpppbpobXkuIrnmoTnu5HlrprmjInpkq4g6I635Y+W55Sf5Lqn5L+d5a2Y5pWw5o2uCiAgICBnZXRCaW5kYnV0bigpewogICAgICBnZXRCaW5kYnV0bih7fSkudGhlbigocmVzKT0+ewogICAgICAgIGlmIChyZXMuZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnLS1nZXRCaW5kYnV0bi0tPjonLHJlcykKICAgICAgICB9IGVsc2UgewogICAgICAgICAgVG9hc3QocmVzLmRhdGEubXNnKQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaXNXZWNoYXQoKSB7CiAgICAgIGNvbnN0IHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTsKICAgICAgaWYgKHVhLm1hdGNoKC9taWNyb21lc3Nlbmdlci9pKSA9PSAnbWljcm9tZXNzZW5nZXInKSB7CiAgICAgICAgLy8gcmV0dXJuIHRydWU7CiAgICAgICAgY29uc29sZS5sb2coJ+W+ruS/oea1j+iniOWZqCcpOwogICAgICAgIHRoaXMuc2NhblFSSnNzZGsoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygn5pmu6YCa5rWP6KeI5ZmoLOivt+WcqOaJi+acuuW+ruS/oea1j+iniOWZqOaJk+W8gOatpOmhtemdoicpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIC8vIOWIneWni+WMlnNka+mFjee9rgogICAgYXN5bmMgc2NhblFSSnNzZGsoKSB7CiAgICAgIC8vIGFsZXJ0KGB1cmzpk77mjqU6JHt3aW5kb3cubG9jYXRpb24uaHJlZn1gKTsKCSAgY29uc3QgdSA9IG5hdmlnYXRvci51c2VyQWdlbnQ7CiAgICAgIGNvbnN0IGlzQW5kcm9pZCA9IHUuaW5kZXhPZignQW5kcm9pZCcpID4gLTEgfHwgdS5pbmRleE9mKCdMaW51eCcpID4gLTE7IC8vIEFuZHJvaWQKICAgICAgY29uc3QgaXNJT1MgPSBuYXZpZ2F0b3IucGxhdGZvcm0uaW5kZXhPZignaVBob25lJykgIT0gLTE7Ly9pb3MKICAgICAgIGxldCB1cmwgPSAnJzsKICAgICAgaWYgKGlzQW5kcm9pZCkgewogICAgICAgIHVybCA9IGxvY2F0aW9uLmhyZWY7CiAgICAgIH0KICAgICAgaWYgKGlzSU9TKSB7CiAgICAgICAgdXJsID0gbG9jYXRpb24uaHJlZi5zcGxpdCgnIycpWzBdOyAvLyBoYXNo5qih5byP5LiLLCPlkI7pnaLnmoTpg6jliIblpoLmnpzluKbkuIppb3PkuK1jb25maWfkvJrkuI3lr7kKICAgICAgfQogICAgICBjb25zdCBhcGkgPSBbXTsKICAgICAgLy8gJ3FyQ29kZScsJ2JhckNvZGUnCiAgICAgIGFwaS5wdXNoKCdxckNvZGUnKTsKICAgICAgYXBpLnB1c2goJ2JhckNvZGUnKTsKICAgICAgLy8gYWxlcnQodXJsKTsKICAgICAgY29uc3QgcmVzRGF0YSA9IGF3YWl0IGdldEpTU0RLSEVMUCh7IHVybCB9KTsJLy8g5qC55o2u5o6l5Y+j6L+U5ZueYXBwSWTvvIx0aW1lc3RhbXDnrYnmlbDmja4KICAgICAgY29uc29sZS5sb2coJ+iOt+WPluW+ruS/oemFjee9rue7k+aenCcsIHJlc0RhdGEpOwogICAgICBpZiAocmVzRGF0YSkgewogICAgICAgIC8vIGFsZXJ0KEpTT04uc3RyaW5naWZ5KHJlc0RhdGEuZGF0YSkpOwogICAgICAgIHd4LmNvbmZpZyh7CiAgICAgICAgICAvLyBiZXRhOiB0cnVlLAogICAgICAgICAgZGVidWc6IGZhbHNlLAogICAgICAgICAgYXBwSWQ6IHJlc0RhdGEuZGF0YS5hcHBJZCwKICAgICAgICAgIHRpbWVzdGFtcDogcmVzRGF0YS5kYXRhLnRpbWVzdGFtcCwKICAgICAgICAgIG5vbmNlU3RyOiByZXNEYXRhLmRhdGEubm9uY2VTdHIsCiAgICAgICAgICBzaWduYXR1cmU6IHJlc0RhdGEuZGF0YS5zaWduYXR1cmUsCiAgICAgICAgICBqc0FwaUxpc3Q6IFsnY2hlY2tKc0FwaScsICdzY2FuUVJDb2RlJ10KICAgICAgICB9KTsKICAgICAgICB3eC5yZWFkeSgoKSA9PiB7CiAgICAgICAgICB3eC5jaGVja0pzQXBpKHsKICAgICAgICAgICAganNBcGlMaXN0OiBbJ3NjYW5RUkNvZGUnXSwKICAgICAgICAgICAgc3VjY2VzcyhyZXMpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnYWFhYScsIHJlcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHd4LmVycm9yKChyZXMpID0+IHsKICAgICAgICAgIGFsZXJ0KGDlh7rplJnkuobvvJoke3Jlcy5lcnJNc2d9YCk7Ly8g6L+Z5Liq5Zyw5pa555qE5aW95aSE5bCx5pivd3guY29uZmln6YWN572u6ZSZ6K+v77yM5Lya5by55Ye656qX5Y+j5ZOq6YeM6ZSZ6K+v77yM54S2CQnlkI7moLnmja7lvq7kv6HmlofmoaPmn6Xor6LljbPlj6/jgIIKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIE9uUVJjb2RlKCkgewkvLyDngrnlh7vnmoTml7blgJnosIPotbfmiavkuIDmiavlip/og73lkaIKICAgICAgaWYodGhpcy5pc0VkaXQpewoKICAgICAgfWVsc2V7CiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CiAgICAgICAgd3guc2NhblFSQ29kZSh7CiAgICAgICAgICBuZWVkUmVzdWx0OiAxLCAvLyDpu5jorqTkuLow77yM5omr5o+P57uT5p6c55Sx5b6u5L+h5aSE55CG77yMMeWImeebtOaOpei/lOWbnuaJq+aPj+e7k+aenO+8jAogICAgICAgICAgc2NhblR5cGU6IFsncXJDb2RlJywgJ2JhckNvZGUnXSwgLy8g5Y+v5Lul5oyH5a6a5omr5LqM57u056CB6L+Y5piv5LiA57u056CB77yM6buY6K6k5LqM6ICF6YO95pyJCiAgICAgICAgICBzdWNjZXNzKHJlcykgewogICAgICAgICAgICBjb25zdCByZXN1bHRTdHJBcnIgPSByZXMucmVzdWx0U3RyLnNwbGl0KCcsJyk7CQkKICAgICAgICAgICAgLy8g6L2s5Li65pWw57uE5pe25Li65LqG6YG/5YWN5omr5o+P5LiA57u056CB5piv6L+U5ZueQ09ERV8xMjgsMjAxODA1MjjliY3pnaLkvJrmt7vliqDkuIDkuKpDT0RFXzEyOOaJgOS7pei9rOS4uuaVsOe7hOiOtwkJ5Y+W5pyA5ZCO5LiA5p2h5bCx6KGM5LqGCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdFN0ckFycltyZXN1bHRTdHJBcnIubGVuZ3RoIC0gMV0pOyAvLyDovpPlh7rmiavnoIHkv6Hmga8KICAgICAgICAgICAgdGhhdC5yZXN1bHQgPSByZXN1bHRTdHJBcnJbcmVzdWx0U3RyQXJyLmxlbmd0aCAtIDFdOwogICAgICAgICAgICB0aGF0LmxhYmVsX3NuID0gcmVzdWx0U3RyQXJyW3Jlc3VsdFN0ckFyci5sZW5ndGggLSAxXTsKICAgICAgICAgIH0sCiAgICAgICAgICBmYWlsKHJlcykgewogICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyJywgcmVzKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgICBoYW5kbGVUaXRsZUJhY2soKSB7CiAgICAgIHRoaXMuJHJvdXRlci5iYWNrKCk7CiAgICB9LAogICAgYmluZFNlbGVjdChlKXsKICAgICAgdGhpcy5sYWJlbEluZGV4ID0gZS50YXJnZXQuZGF0YXNldC5pbmRleDsKICAgICAgaWYodGhpcy5udW1iZXJUeXBlID09IDEpewogICAgICAgIHRoaXMubGFiZWxfc25fb2xkID0gZS50YXJnZXQuZGF0YXNldC5saW5lY29udGVudDsKICAgICAgfQoKICAgICAgaWYodGhpcy5udW1iZXJUeXBlID09IDApewogICAgICAgIHRoaXMuY2hhc3Npc19zbl9vbGQgPSBlLnRhcmdldC5kYXRhc2V0LmxpbmVjb250ZW50OwogICAgICB9CiAgICAgIAogICAgICBpZih0aGlzLm51bWJlclR5cGUgPT0gMil7CiAgICAgICAgdGhpcy5pbnN0cnVtZW50X3NuX29sZCA9IGUudGFyZ2V0LmRhdGFzZXQubGluZWNvbnRlbnQ7CiAgICAgIH0KCiAgICAgIGlmKHRoaXMubnVtYmVyVHlwZSA9PSAzKXsKICAgICAgICB0aGlzLm51bTFfc25fb2xkID0gZS50YXJnZXQuZGF0YXNldC5saW5lY29udGVudDsKICAgICAgfQoKICAgICAgaWYodGhpcy5udW1iZXJUeXBlID09IDQpewogICAgICAgIHRoaXMubnVtMl9zbl9vbGQgPSBlLnRhcmdldC5kYXRhc2V0LmxpbmVjb250ZW50OwogICAgICB9CiAgICAgICAgICAgICAgICAgICAgIAogICAgICBpZih0aGlzLm51bWJlclR5cGUgPT0gNSl7CiAgICAgICAgdGhpcy5udW0zX3NuX29sZCA9IGUudGFyZ2V0LmRhdGFzZXQubGluZWNvbnRlbnQ7CiAgICAgIH0KCiAgICAgIGlmKHRoaXMubnVtYmVyVHlwZSA9PSA2KXsKICAgICAgICB0aGlzLm51bTRfc25fb2xkID0gZS50YXJnZXQuZGF0YXNldC5saW5lY29udGVudDsKICAgICAgfQogICAgfSwKICAgIGJlZm9yZUNsb3NlKGFjdGlvbiwgZG9uZSkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgICAgICAgICAgICBpZihhY3Rpb24gPT09ICdjb25maXJtJykgewogICAgICAgICAgICAgICAgICBpZih0aGlzLm51bWJlclR5cGUgPT0gMSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGFiZWxfc24gPSB0aGlzLmxhYmVsX3NuX29sZDsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWd1cmwxID0gdGhpcy5pbWd1cmwxX29sZDsKICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICBpZih0aGlzLm51bWJlclR5cGUgPT0gMCl7CiAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hTTih7CiAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnMCcsCiAgICAgICAgICAgICAgICAgICAgICAgICBTTjogdGhpcy5jaGFzc2lzX3NuX29sZAogICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlcyk9PnsKICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmNoYXNzaXNfc24gPSB0aGF0LmNoYXNzaXNfc25fb2xkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5pbWd1cmwgPSB0aGF0LmltZ3VybF9vbGQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvYXN0KHJlcy5kYXRhLm1zZykKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm51bWJlclR5cGUgPT0gMil7CiAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoU04oewogICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJzAnLAogICAgICAgICAgICAgICAgICAgICAgICAgU046IHRoaXMuaW5zdHJ1bWVudF9zbl9vbGQKICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKChyZXMpPT57CiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5pbnN0cnVtZW50X3NuID0gdGhhdC5pbnN0cnVtZW50X3NuX29sZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuaW1ndXJsMiA9IHRoYXQuaW1ndXJsMl9vbGQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvYXN0KHJlcy5kYXRhLm1zZykKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm51bWJlclR5cGUgPT0gMyl7CiAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoU04oewogICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJzEnLAogICAgICAgICAgICAgICAgICAgICAgICAgU046IHRoaXMubnVtMV9zbl9vbGQKICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKChyZXMpPT57CiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5udW0xX3NuID0gdGhhdC5udW0xX3NuX29sZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuaW1ndXJsMyA9IHRoYXQuaW1ndXJsM19vbGQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvYXN0KHJlcy5kYXRhLm1zZykKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm51bWJlclR5cGUgPT0gNCl7CiAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoU04oewogICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJzEnLAogICAgICAgICAgICAgICAgICAgICAgICAgU046IHRoaXMubnVtMl9zbl9vbGQKICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKChyZXMpPT57CiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5udW0yX3NuID0gdGhhdC5udW0yX3NuX29sZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuaW1ndXJsNCA9IHRoYXQuaW1ndXJsNF9vbGQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvYXN0KHJlcy5kYXRhLm1zZykKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICBpZih0aGlzLm51bWJlclR5cGUgPT0gNSl7CiAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoU04oewogICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJzEnLAogICAgICAgICAgICAgICAgICAgICAgICAgU046IHRoaXMubnVtM19zbl9vbGQKICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKChyZXMpPT57CiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5udW0zX3NuID0gdGhhdC5udW0zX3NuX29sZDsKICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmltZ3VybDUgPSB0aGF0LmltZ3VybDVfb2xkOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb2FzdChyZXMuZGF0YS5tc2cpCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5udW1iZXJUeXBlID09IDYpewogICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFNOKHsKICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICcxJywKICAgICAgICAgICAgICAgICAgICAgICAgIFNOOiB0aGlzLm51bTRfc25fb2xkCiAgICAgICAgICAgICAgICAgICAgICAgfSkudGhlbigocmVzKT0+ewogICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5udW00X3NuID0gdGhhdC5udW00X3NuX29sZDsKICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmltZ3VybDYgPSB0aGF0LmltZ3VybDZfb2xkOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb2FzdChyZXMuZGF0YS5tc2cpCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgIGRvbmUoKQogICAgICAgICAgICAgICAgfSBlbHNlIGlmKGFjdGlvbiA9PT0gJ2NhbmNlbCcpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5jaGFzc2lzX3NuID0gJyc7CiAgICAgICAgICAgICAgICAgIHRoaXMubGFiZWxJbmRleCA9IC0xOwogICAgICAgICAgICAgICAgICAgIGRvbmUoKSAvL+WFs+mXrQogICAgICAgICAgICAgICAgfQogICAgfSwKICAgIHNldFBpY0ltZyh2YWx1ZSxudW1iZXIpewogICAgICAgCiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgaWYodmFsdWUpewogICAgICAgIAogICAgICAgVG9hc3QubG9hZGluZyh7CiAgICAgICAgIGR1cmF0aW9uOiAyMDAwLCAvLyDmjIHnu63lsZXnpLogdG9hc3QKICAgICAgICAgZm9yYmlkQ2xpY2s6IHRydWUsCiAgICAgICAgIG1lc3NhZ2U6ICLliqDovb3kuK0uLi4iCiAgICAgfSk7CgogICAgICAgIGxldCBzdGFydCA9IHZhbHVlLmluZGV4T2YoJywnKSArIDE7CiAgICAgICAgICAgICAgICAgIGxldCBkYXRhdXJsID0gdmFsdWUuc3Vic3RyKHN0YXJ0KTsKICAgICAgICAgICAgICAgICAgIHVwbG9hZEltZ0JpbmQoewogICAgICAgICAgICAgICAgICAgICAnaW1hZ2VfNjQnOiBkYXRhdXJsLAogICAgICAgICAgICAgICAgICAgfSkudGhlbigocmVzKT0+ewogICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyID09IDEpewogICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuaW1ndXJsMV9vbGQgPSByZXMuZGF0YS5tc2cKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXIgPT0gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5pbWd1cmxfb2xkID0gcmVzLmRhdGEubXNnCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyID09IDIpewogICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuaW1ndXJsMl9vbGQgPSByZXMuZGF0YS5tc2cKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXIgPT0gMyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5pbWd1cmwzX29sZCA9IHJlcy5kYXRhLm1zZwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG51bWJlciA9PSA0KXsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmltZ3VybDRfb2xkID0gcmVzLmRhdGEubXNnCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYobnVtYmVyID09IDUpewogICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuaW1ndXJsNV9vbGQgPSByZXMuZGF0YS5tc2cKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZihudW1iZXIgPT0gNil7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5pbWd1cmw2X29sZCA9IHJlcy5kYXRhLm1zZwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBUb2FzdChyZXMuZGF0YS5tc2cpCiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyKT0+ewogICAgICAgICAgICAgICAgICAgICAgVG9hc3QoZXJyKQogICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgIHVkYXRlSDVJbWFnZXMoewogICAgICAgICAgICAgICAgICAgICdpbWFnZV9iYXNlNjQnOnZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgJ2FwaV9rZXknOiAnZ1Fmei1NbkdJdVJVYnR6Sks4d0JfeDFaVkVjNDVKMEgnLCAvL+ivt+Whq+WGmeS9oOWIm+W7uueahCBhcGlrZXkKICAgICAgICAgICAgICAgICAgICAgICdhcGlfc2VjcmV0JzogJ0dObDl2SURfNUtqenpiRzJVRzUxdnN3dlllYjA2dm51JywKICAgICAgICAgICAgICAgICAgfSkudGhlbigocmVzKT0+ewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcykKICAgICAgICAgICAgICAgICAgICAgIHRoYXQubnVtYmVyTGlzdCA9IHJlcy5kYXRhLnRleHRfaW5mbzsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBsZXQgbnVtYmVyTGlzdE5ldyA9IFtdOwogICAgICAgICAgICAgICAgICAgIGxldCByZWcgPSAvW15hLXpcZF0vaWc7CiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpID0wO2k8IHRoYXQubnVtYmVyTGlzdC5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgICAgICAgICAgIGxldCBpdGVtID0gdGhhdC5udW1iZXJMaXN0W2ldOwogICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbS5saW5lX2NvbnRlbnQhPSBudWxsICYmIGl0ZW0ubGluZV9jb250ZW50ICE9ICIiKXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbS5saW5lX2NvbnRlbnQuaW5kZXhPZigiOiIpID49MCB8fCBpdGVtLmxpbmVfY29udGVudC5pbmRleE9mKCLvvJoiKT49MCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5saW5lX2NvbnRlbnQgPSBpdGVtLmxpbmVfY29udGVudC5zcGxpdCgiOiIpWzFdIHx8IGl0ZW0ubGluZV9jb250ZW50LnNwbGl0KCLvvJoiKVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmxpbmVfY29udGVudCA9IGl0ZW0ubGluZV9jb250ZW50LnJlcGxhY2UocmVnLCAiIikKICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5saW5lX2NvbnRlbnQgPSBpdGVtLmxpbmVfY29udGVudC5yZXBsYWNlKHJlZywgIiIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbS5saW5lX2NvbnRlbnQubGVuZ3RoID49IHRoYXQubGFibGVMZW5ndGgpewogICAgICAgICAgICAgICAgICAgICAgICAgIG51bWJlckxpc3ROZXcucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSAgCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoYXQubnVtYmVyTGlzdCA9IG51bWJlckxpc3ROZXcKICAgICAgICAgICAgICAgICAgICAgIGlmKHRoYXQubnVtYmVyTGlzdC5sZW5ndGg+IDApewogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmxhYmVsSW5kZXg9IC0xOwogICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmlzU2hvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQubnVtYmVyVHlwZSA9IG51bWJlcjsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZUZpbGVJbWcxKCkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIGxldCB1cGxvYWRJbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXBsb2FkSW1nMScpCiAgICAvLyDkuLrkuobojrflj5blm77niYfnmoTmnKzlnLDot6/lvoQKICAgICAgICB3aW5kb3cuVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMOwogICAgLy8g6I635Y+W56e75Yqo56uv57G75Z6LQW5kcm9pZCAgIGlQaG9uZSAgaXBhZAogICAgICAgIGxldCBzVXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpOwogICAgLy8g6I635Y+W5b2T5YmN5Zu+54mH5L+h5oGv77yI5Y2V5byg5Zu+54mH5LiK5Lyg77yJCiAgICAgICAgbGV0IHNlbGVjdGVkX2ZpbGUgPSB1cGxvYWRJbWcuZmlsZXNbMF07CiAgICAgICAgY29uc29sZS5sb2coc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgaWYgKHNVc2VyQWdlbnQubWF0Y2goL2FuZHJvaWQvaSkgPT0gImFuZHJvaWQiKSB7CiAgICAgICAgICBsZXQgaW1nMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWcxJyk7CiAgICAgICAgICAgIGxldCBpbWcgPSBuZXcgSW1hZ2UoKTsKICAgIAkgICAgLy8g55Sf5oiQ5LiA5Liq5pys5Zyw5Zu+54mH5bGV56S66Lev5b6ECiAgICAgICAgICAgIGltZy5zcmMgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7Ly/nroDljZXmnaXor7TlsLHmmK/lvILmraXor7vlj5bnlLXohJHkuK3nmoTmlofku7YKICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBpbWd1cmwxID0gZS50YXJnZXQucmVzdWx0OwoKICAgICAgICAgICAgICAgIGlmKGUudGFyZ2V0LnJlc3VsdC5sZW5ndGggLyAxMDI0ID4gMTAyNSl7CiAgICAgICAgICAgICAgICAgIHRoYXQuY2FudmFzRGF0YVVSTChlLnRhcmdldC5yZXN1bHQsIHtxdWFsaXR5OiAwLjd9LCBmdW5jdGlvbiAoYmFzZTY0Q29kZXMpIHsKICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFBpY0ltZyhiYXNlNjRDb2RlcywxKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgdGhhdC5zZXRQaWNJbWcoZS50YXJnZXQucmVzdWx0LDEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBpbWcxLnNyYyA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZihzZWxlY3RlZF9maWxlKXsKICAgICAgICAgICAgICAvL+WIpOaWreaWh+S7tuexu+Wei+aYr+WQpuS4uuWbvueJhwogICAgICAgICAgICAgIGlmICghc2VsZWN0ZWRfZmlsZS50eXBlLm1hdGNoKC9pbWFnZS4qLykpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICBsZXQgaW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltZzEnKTsKICAgICAgICAgICAgICAvLyBiYXNlNjTotYvlgLwKICAgICAgICAgICAgICBpbWcuZmlsZSA9IHNlbGVjdGVkX2ZpbGU7CiAgICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgaW1ndXJsMSA9IGltZy5zcmM7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgaW1nLnNyYyA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgICAgICAgaW1ndXJsMSA9IGltZy5zcmM7CgogICAgICAgICAgICAgICAgICBpZihlLnRhcmdldC5yZXN1bHQubGVuZ3RoIC8gMTAyNCA+IDEwMjUpewogICAgICAgICAgICAgICAgICAgIHRoYXQuY2FudmFzRGF0YVVSTChlLnRhcmdldC5yZXN1bHQsIHtxdWFsaXR5OiAwLjd9LCBmdW5jdGlvbiAoYmFzZTY0Q29kZXMpIHsKICAgICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGJhc2U2NENvZGVzLDEpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFBpY0ltZyhlLnRhcmdldC5yZXN1bHQsMSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgaGFuZGxlRmlsZUltZygpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICBsZXQgdXBsb2FkSW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VwbG9hZEltZycpCiAgICAvLyDkuLrkuobojrflj5blm77niYfnmoTmnKzlnLDot6/lvoQKICAgICAgICB3aW5kb3cuVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMOwogICAgLy8g6I635Y+W56e75Yqo56uv57G75Z6LQW5kcm9pZCAgIGlQaG9uZSAgaXBhZAogICAgICAgIGxldCBzVXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpOwogICAgLy8g6I635Y+W5b2T5YmN5Zu+54mH5L+h5oGv77yI5Y2V5byg5Zu+54mH5LiK5Lyg77yJCiAgICAgICAgbGV0IHNlbGVjdGVkX2ZpbGUgPSB1cGxvYWRJbWcuZmlsZXNbMF07CiAgICAgICAgY29uc29sZS5sb2coc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgaWYgKHNVc2VyQWdlbnQubWF0Y2goL2FuZHJvaWQvaSkgPT0gImFuZHJvaWQiKSB7CiAgICAgICAgICBsZXQgaW1nMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWcnKTsKICAgICAgICAgICAgbGV0IGltZyA9IG5ldyBJbWFnZSgpOwogICAgCSAgICAvLyDnlJ/miJDkuIDkuKrmnKzlnLDlm77niYflsZXnpLrot6/lvoQKICAgICAgICAgICAgaW1nLnNyYyA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsvL+eugOWNleadpeivtOWwseaYr+W8guatpeivu+WPlueUteiEkeS4reeahOaWh+S7tgogICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGltZ3VybCA9IGUudGFyZ2V0LnJlc3VsdDsKCiAgICAgICAgICAgICAgICBpZihlLnRhcmdldC5yZXN1bHQubGVuZ3RoIC8gMTAyNCA+IDEwMjUpewogICAgICAgICAgICAgICAgICAgIHRoYXQuY2FudmFzRGF0YVVSTChlLnRhcmdldC5yZXN1bHQsIHtxdWFsaXR5OiAwLjd9LCBmdW5jdGlvbiAoYmFzZTY0Q29kZXMpIHsKICAgICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGJhc2U2NENvZGVzLDApOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFBpY0ltZyhlLnRhcmdldC5yZXN1bHQsMCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgaW1nMS5zcmMgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYoc2VsZWN0ZWRfZmlsZSl7CiAgICAgICAgICAgICAgLy/liKTmlq3mlofku7bnsbvlnovmmK/lkKbkuLrlm77niYcKICAgICAgICAgICAgICBpZiAoIXNlbGVjdGVkX2ZpbGUudHlwZS5tYXRjaCgvaW1hZ2UuKi8pKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgbGV0IGltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWcnKTsKICAgICAgICAgICAgICAvLyBiYXNlNjTotYvlgLwKICAgICAgICAgICAgICBpbWcuZmlsZSA9IHNlbGVjdGVkX2ZpbGU7CiAgICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgaW1ndXJsID0gaW1nLnNyYzsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICBpbWcuc3JjID0gZS50YXJnZXQucmVzdWx0OwogICAgICAgICAgICAgICAgICBpbWd1cmwgPSBpbWcuc3JjOwoKICAgICAgICAgICAgICAgIGlmKGUudGFyZ2V0LnJlc3VsdC5sZW5ndGggLyAxMDI0ID4gMTAyNSl7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5jYW52YXNEYXRhVVJMKGUudGFyZ2V0LnJlc3VsdCwge3F1YWxpdHk6IDAuN30sIGZ1bmN0aW9uIChiYXNlNjRDb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRQaWNJbWcoYmFzZTY0Q29kZXMsMCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGUudGFyZ2V0LnJlc3VsdCwwKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgIGhhbmRsZUZpbGVJbWcyKCkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIGxldCB1cGxvYWRJbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXBsb2FkSW1nMicpCiAgICAvLyDkuLrkuobojrflj5blm77niYfnmoTmnKzlnLDot6/lvoQKICAgICAgICB3aW5kb3cuVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMOwogICAgLy8g6I635Y+W56e75Yqo56uv57G75Z6LQW5kcm9pZCAgIGlQaG9uZSAgaXBhZAogICAgICAgIGxldCBzVXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpOwogICAgLy8g6I635Y+W5b2T5YmN5Zu+54mH5L+h5oGv77yI5Y2V5byg5Zu+54mH5LiK5Lyg77yJCiAgICAgICAgbGV0IHNlbGVjdGVkX2ZpbGUgPSB1cGxvYWRJbWcuZmlsZXNbMF07CiAgICAgICAgY29uc29sZS5sb2coc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgaWYgKHNVc2VyQWdlbnQubWF0Y2goL2FuZHJvaWQvaSkgPT0gImFuZHJvaWQiKSB7CiAgICAgICAgICBsZXQgaW1nMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWcyJyk7CiAgICAgICAgICAgIGxldCBpbWcgPSBuZXcgSW1hZ2UoKTsKICAgIAkgICAgLy8g55Sf5oiQ5LiA5Liq5pys5Zyw5Zu+54mH5bGV56S66Lev5b6ECiAgICAgICAgICAgIGltZy5zcmMgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7Ly/nroDljZXmnaXor7TlsLHmmK/lvILmraXor7vlj5bnlLXohJHkuK3nmoTmlofku7YKICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBpbWd1cmwyID0gZS50YXJnZXQucmVzdWx0OwoKICAgICAgICAgICAgICAgIGlmKGUudGFyZ2V0LnJlc3VsdC5sZW5ndGggLyAxMDI0ID4gMTAyNSl7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5jYW52YXNEYXRhVVJMKGUudGFyZ2V0LnJlc3VsdCwge3F1YWxpdHk6IDAuN30sIGZ1bmN0aW9uIChiYXNlNjRDb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRQaWNJbWcoYmFzZTY0Q29kZXMsMik7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGUudGFyZ2V0LnJlc3VsdCwyKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBpbWcxLnNyYyA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZihzZWxlY3RlZF9maWxlKXsKICAgICAgICAgICAgICAvL+WIpOaWreaWh+S7tuexu+Wei+aYr+WQpuS4uuWbvueJhwogICAgICAgICAgICAgIGlmICghc2VsZWN0ZWRfZmlsZS50eXBlLm1hdGNoKC9pbWFnZS4qLykpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICBsZXQgaW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltZzInKTsKICAgICAgICAgICAgICAvLyBiYXNlNjTotYvlgLwKICAgICAgICAgICAgICBpbWcuZmlsZSA9IHNlbGVjdGVkX2ZpbGU7CiAgICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgaW1ndXJsMiA9IGltZy5zcmM7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgaW1nLnNyYyA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgICAgICAgaW1ndXJsMiA9IGltZy5zcmM7CgogICAgICAgICAgICAgICAgaWYoZS50YXJnZXQucmVzdWx0Lmxlbmd0aCAvIDEwMjQgPiAxMDI1KXsKICAgICAgICAgICAgICAgICAgICB0aGF0LmNhbnZhc0RhdGFVUkwoZS50YXJnZXQucmVzdWx0LCB7cXVhbGl0eTogMC43fSwgZnVuY3Rpb24gKGJhc2U2NENvZGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFBpY0ltZyhiYXNlNjRDb2RlcywyKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRQaWNJbWcoZS50YXJnZXQucmVzdWx0LDIpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICAgaGFuZGxlRmlsZUltZzMoKSB7CiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgbGV0IHVwbG9hZEltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cGxvYWRJbWczJykKICAgIC8vIOS4uuS6huiOt+WPluWbvueJh+eahOacrOWcsOi3r+W+hAogICAgICAgIHdpbmRvdy5VUkwgPSB3aW5kb3cuVVJMIHx8IHdpbmRvdy53ZWJraXRVUkw7CiAgICAvLyDojrflj5bnp7vliqjnq6/nsbvlnotBbmRyb2lkICAgaVBob25lICBpcGFkCiAgICAgICAgbGV0IHNVc2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCk7CiAgICAvLyDojrflj5blvZPliY3lm77niYfkv6Hmga/vvIjljZXlvKDlm77niYfkuIrkvKDvvIkKICAgICAgICBsZXQgc2VsZWN0ZWRfZmlsZSA9IHVwbG9hZEltZy5maWxlc1swXTsKICAgICAgICBjb25zb2xlLmxvZyhzZWxlY3RlZF9maWxlKTsKICAgICAgICBpZiAoc1VzZXJBZ2VudC5tYXRjaCgvYW5kcm9pZC9pKSA9PSAiYW5kcm9pZCIpIHsKICAgICAgICAgIGxldCBpbWcxID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltZzMnKTsKICAgICAgICAgICAgbGV0IGltZyA9IG5ldyBJbWFnZSgpOwogICAgCSAgICAvLyDnlJ/miJDkuIDkuKrmnKzlnLDlm77niYflsZXnpLrot6/lvoQKICAgICAgICAgICAgaW1nLnNyYyA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsvL+eugOWNleadpeivtOWwseaYr+W8guatpeivu+WPlueUteiEkeS4reeahOaWh+S7tgogICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGltZ3VybDMgPSBlLnRhcmdldC5yZXN1bHQ7CgogICAgICAgICAgICAgICBpZihlLnRhcmdldC5yZXN1bHQubGVuZ3RoIC8gMTAyNCA+IDEwMjUpewogICAgICAgICAgICAgICAgICAgIHRoYXQuY2FudmFzRGF0YVVSTChlLnRhcmdldC5yZXN1bHQsIHtxdWFsaXR5OiAwLjd9LCBmdW5jdGlvbiAoYmFzZTY0Q29kZXMpIHsKICAgICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGJhc2U2NENvZGVzLDMpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFBpY0ltZyhlLnRhcmdldC5yZXN1bHQsMyk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9OwogICAgICAgICAgICBpbWcxLnNyYyA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZihzZWxlY3RlZF9maWxlKXsKICAgICAgICAgICAgICAvL+WIpOaWreaWh+S7tuexu+Wei+aYr+WQpuS4uuWbvueJhwogICAgICAgICAgICAgIGlmICghc2VsZWN0ZWRfZmlsZS50eXBlLm1hdGNoKC9pbWFnZS4qLykpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICBsZXQgaW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltZzMnKTsKICAgICAgICAgICAgICAvLyBiYXNlNjTotYvlgLwKICAgICAgICAgICAgICBpbWcuZmlsZSA9IHNlbGVjdGVkX2ZpbGU7CiAgICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgaW1ndXJsMyA9IGltZy5zcmM7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBsZXQgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgaW1nLnNyYyA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgICAgICAgaW1ndXJsMyA9IGltZy5zcmM7CgogICAgICAgICAgICAgICAgaWYoZS50YXJnZXQucmVzdWx0Lmxlbmd0aCAvIDEwMjQgPiAxMDI1KXsKICAgICAgICAgICAgICAgICAgICB0aGF0LmNhbnZhc0RhdGFVUkwoZS50YXJnZXQucmVzdWx0LCB7cXVhbGl0eTogMC43fSwgZnVuY3Rpb24gKGJhc2U2NENvZGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFBpY0ltZyhiYXNlNjRDb2RlcywzKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRQaWNJbWcoZS50YXJnZXQucmVzdWx0LDMpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgIGhhbmRsZUZpbGVJbWc0KCkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIGxldCB1cGxvYWRJbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXBsb2FkSW1nNCcpCiAgICAvLyDkuLrkuobojrflj5blm77niYfnmoTmnKzlnLDot6/lvoQKICAgICAgICB3aW5kb3cuVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMOwogICAgLy8g6I635Y+W56e75Yqo56uv57G75Z6LQW5kcm9pZCAgIGlQaG9uZSAgaXBhZAogICAgICAgIGxldCBzVXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpOwogICAgLy8g6I635Y+W5b2T5YmN5Zu+54mH5L+h5oGv77yI5Y2V5byg5Zu+54mH5LiK5Lyg77yJCiAgICAgICAgbGV0IHNlbGVjdGVkX2ZpbGUgPSB1cGxvYWRJbWcuZmlsZXNbMF07CiAgICAgICAgY29uc29sZS5sb2coc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgaWYgKHNVc2VyQWdlbnQubWF0Y2goL2FuZHJvaWQvaSkgPT0gImFuZHJvaWQiKSB7CiAgICAgICAgICBsZXQgaW1nMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWc0Jyk7CiAgICAgICAgICAgIGxldCBpbWcgPSBuZXcgSW1hZ2UoKTsKICAgIAkgICAgLy8g55Sf5oiQ5LiA5Liq5pys5Zyw5Zu+54mH5bGV56S66Lev5b6ECiAgICAgICAgICAgIGltZy5zcmMgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7Ly/nroDljZXmnaXor7TlsLHmmK/lvILmraXor7vlj5bnlLXohJHkuK3nmoTmlofku7YKICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBpbWd1cmw0ID0gZS50YXJnZXQucmVzdWx0OwoKICAgICAgICAgICAgICAgIGlmKGUudGFyZ2V0LnJlc3VsdC5sZW5ndGggLyAxMDI0ID4gMTAyNSl7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5jYW52YXNEYXRhVVJMKGUudGFyZ2V0LnJlc3VsdCwge3F1YWxpdHk6IDAuN30sIGZ1bmN0aW9uIChiYXNlNjRDb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRQaWNJbWcoYmFzZTY0Q29kZXMsNCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGUudGFyZ2V0LnJlc3VsdCw0KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGltZzEuc3JjID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmKHNlbGVjdGVkX2ZpbGUpewogICAgICAgICAgICAgIC8v5Yik5pat5paH5Lu257G75Z6L5piv5ZCm5Li65Zu+54mHCiAgICAgICAgICAgICAgaWYgKCFzZWxlY3RlZF9maWxlLnR5cGUubWF0Y2goL2ltYWdlLiovKSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgIGxldCBpbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1nNCcpOwogICAgICAgICAgICAgIC8vIGJhc2U2NOi1i+WAvAogICAgICAgICAgICAgIGltZy5maWxlID0gc2VsZWN0ZWRfZmlsZTsKICAgICAgICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBpbWd1cmw0ID0gaW1nLnNyYzsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICBpbWcuc3JjID0gZS50YXJnZXQucmVzdWx0OwogICAgICAgICAgICAgICAgICBpbWd1cmw0ID0gaW1nLnNyYzsKCiAgICAgICAgICAgICAgICBpZihlLnRhcmdldC5yZXN1bHQubGVuZ3RoIC8gMTAyNCA+IDEwMjUpewogICAgICAgICAgICAgICAgICAgIHRoYXQuY2FudmFzRGF0YVVSTChlLnRhcmdldC5yZXN1bHQsIHtxdWFsaXR5OiAwLjd9LCBmdW5jdGlvbiAoYmFzZTY0Q29kZXMpIHsKICAgICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGJhc2U2NENvZGVzLDQpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFBpY0ltZyhlLnRhcmdldC5yZXN1bHQsNCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgICBoYW5kbGVGaWxlSW1nNSgpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICBsZXQgdXBsb2FkSW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VwbG9hZEltZzUnKQogICAgLy8g5Li65LqG6I635Y+W5Zu+54mH55qE5pys5Zyw6Lev5b6ECiAgICAgICAgd2luZG93LlVSTCA9IHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTDsKICAgIC8vIOiOt+WPluenu+WKqOerr+exu+Wei0FuZHJvaWQgICBpUGhvbmUgIGlwYWQKICAgICAgICBsZXQgc1VzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTsKICAgIC8vIOiOt+WPluW9k+WJjeWbvueJh+S/oeaBr++8iOWNleW8oOWbvueJh+S4iuS8oO+8iQogICAgICAgIGxldCBzZWxlY3RlZF9maWxlID0gdXBsb2FkSW1nLmZpbGVzWzBdOwogICAgICAgIGNvbnNvbGUubG9nKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgIGlmIChzVXNlckFnZW50Lm1hdGNoKC9hbmRyb2lkL2kpID09ICJhbmRyb2lkIikgewogICAgICAgICAgbGV0IGltZzEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1nNScpOwogICAgICAgICAgICBsZXQgaW1nID0gbmV3IEltYWdlKCk7CiAgICAJICAgIC8vIOeUn+aIkOS4gOS4quacrOWcsOWbvueJh+Wxleekuui3r+W+hAogICAgICAgICAgICBpbWcuc3JjID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgICAgIGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOy8v566A5Y2V5p2l6K+05bCx5piv5byC5q2l6K+75Y+W55S16ISR5Lit55qE5paH5Lu2CiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgaW1ndXJsNSA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYoZS50YXJnZXQucmVzdWx0Lmxlbmd0aCAvIDEwMjQgPiAxMDI1KXsKICAgICAgICAgICAgICAgICAgICB0aGF0LmNhbnZhc0RhdGFVUkwoZS50YXJnZXQucmVzdWx0LCB7cXVhbGl0eTogMC43fSwgZnVuY3Rpb24gKGJhc2U2NENvZGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFBpY0ltZyhiYXNlNjRDb2Rlcyw1KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRQaWNJbWcoZS50YXJnZXQucmVzdWx0LDUpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfTsKICAgICAgICAgICAgaW1nMS5zcmMgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYoc2VsZWN0ZWRfZmlsZSl7CiAgICAgICAgICAgICAgLy/liKTmlq3mlofku7bnsbvlnovmmK/lkKbkuLrlm77niYcKICAgICAgICAgICAgICBpZiAoIXNlbGVjdGVkX2ZpbGUudHlwZS5tYXRjaCgvaW1hZ2UuKi8pKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgbGV0IGltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWc1Jyk7CiAgICAgICAgICAgICAgLy8gYmFzZTY06LWL5YC8CiAgICAgICAgICAgICAgaW1nLmZpbGUgPSBzZWxlY3RlZF9maWxlOwogICAgICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIGltZ3VybDUgPSBpbWcuc3JjOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgIGltZy5zcmMgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgICAgICAgIGltZ3VybDUgPSBpbWcuc3JjOwoKICAgICAgICAgICAgICAgIGlmKGUudGFyZ2V0LnJlc3VsdC5sZW5ndGggLyAxMDI0ID4gMTAyNSl7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5jYW52YXNEYXRhVVJMKGUudGFyZ2V0LnJlc3VsdCwge3F1YWxpdHk6IDAuN30sIGZ1bmN0aW9uIChiYXNlNjRDb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRQaWNJbWcoYmFzZTY0Q29kZXMsNSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGUudGFyZ2V0LnJlc3VsdCw1KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgICBoYW5kbGVGaWxlSW1nNigpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICBsZXQgdXBsb2FkSW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VwbG9hZEltZzYnKQogICAgLy8g5Li65LqG6I635Y+W5Zu+54mH55qE5pys5Zyw6Lev5b6ECiAgICAgICAgd2luZG93LlVSTCA9IHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTDsKICAgIC8vIOiOt+WPluenu+WKqOerr+exu+Wei0FuZHJvaWQgICBpUGhvbmUgIGlwYWQKICAgICAgICBsZXQgc1VzZXJBZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTsKICAgIC8vIOiOt+WPluW9k+WJjeWbvueJh+S/oeaBr++8iOWNleW8oOWbvueJh+S4iuS8oO+8iQogICAgICAgIGxldCBzZWxlY3RlZF9maWxlID0gdXBsb2FkSW1nLmZpbGVzWzBdOwogICAgICAgIGNvbnNvbGUubG9nKHNlbGVjdGVkX2ZpbGUpOwogICAgICAgIGlmIChzVXNlckFnZW50Lm1hdGNoKC9hbmRyb2lkL2kpID09ICJhbmRyb2lkIikgewogICAgICAgICAgbGV0IGltZzEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1nNicpOwogICAgICAgICAgICBsZXQgaW1nID0gbmV3IEltYWdlKCk7CiAgICAJICAgIC8vIOeUn+aIkOS4gOS4quacrOWcsOWbvueJh+Wxleekuui3r+W+hAogICAgICAgICAgICBpbWcuc3JjID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgICAgIGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOy8v566A5Y2V5p2l6K+05bCx5piv5byC5q2l6K+75Y+W55S16ISR5Lit55qE5paH5Lu2CiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgaW1ndXJsNiA9IGUudGFyZ2V0LnJlc3VsdDsKCiAgICAgICAgICAgICAgICBpZihlLnRhcmdldC5yZXN1bHQubGVuZ3RoIC8gMTAyNCA+IDEwMjUpewogICAgICAgICAgICAgICAgICAgIHRoYXQuY2FudmFzRGF0YVVSTChlLnRhcmdldC5yZXN1bHQsIHtxdWFsaXR5OiAwLjd9LCBmdW5jdGlvbiAoYmFzZTY0Q29kZXMpIHsKICAgICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGJhc2U2NENvZGVzLDYpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFBpY0ltZyhlLnRhcmdldC5yZXN1bHQsNik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgaW1nMS5zcmMgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChzZWxlY3RlZF9maWxlKTsKICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYoc2VsZWN0ZWRfZmlsZSl7CiAgICAgICAgICAgICAgLy/liKTmlq3mlofku7bnsbvlnovmmK/lkKbkuLrlm77niYcKICAgICAgICAgICAgICBpZiAoIXNlbGVjdGVkX2ZpbGUudHlwZS5tYXRjaCgvaW1hZ2UuKi8pKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgbGV0IGltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWc2Jyk7CiAgICAgICAgICAgICAgLy8gYmFzZTY06LWL5YC8CiAgICAgICAgICAgICAgaW1nLmZpbGUgPSBzZWxlY3RlZF9maWxlOwogICAgICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIGltZ3VybDYgPSBpbWcuc3JjOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgbGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgIGltZy5zcmMgPSBlLnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgICAgICAgIGltZ3VybDYgPSBpbWcuc3JjOwoKICAgICAgICAgICAgICAgIGlmKGUudGFyZ2V0LnJlc3VsdC5sZW5ndGggLyAxMDI0ID4gMTAyNSl7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5jYW52YXNEYXRhVVJMKGUudGFyZ2V0LnJlc3VsdCwge3F1YWxpdHk6IDAuN30sIGZ1bmN0aW9uIChiYXNlNjRDb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRQaWNJbWcoYmFzZTY0Q29kZXMsNik7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIHRoYXQuc2V0UGljSW1nKGUudGFyZ2V0LnJlc3VsdCw2KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoc2VsZWN0ZWRfZmlsZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgYmluZEluc3RydW1lbnQoZSkgewogICAgICBsZXQgbnVtYmVyID0gZS50YXJnZXQuZGF0YXNldC5udW1iZXI7CiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgaWYgKHRoaXMubGFiZWxfc24gPT0gJycpIHsKICAgICAgICBUb2FzdCgn6ICz546v57yW5Y+35LiN6IO95Li656m6Jyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLmluc3RydW1lbnRfbmFtZSA9PSAnJykgewogICAgICAgIFRvYXN0KCfor7fpgInmi6nku6rlmajlkI3np7AnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgCiAgICAgIGlmICh0aGlzLmluc3RydW1lbnRfU04gPT0gJycpIHsKICAgICAgICBUb2FzdCgn5Luq5Zmo5bqP5YiX5Y+35LiN6IO95Li656m6Jyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8vIGlmICh0aGlzLmNoYXNzaXMgPT0gJycpIHsKICAgICAgLy8gICBUb2FzdCgn5py66Iqv5bqP5YiX5Y+35LiN6IO95Li656m6Jyk7CiAgICAgIC8vICAgcmV0dXJuOwogICAgICAvLyB9CiAgICAgIGxldCBtb2R1bGUgPSBbXQogICAgICAvLyBpZih0aGlzLm51bTFfc24gJiYgdGhpcy5pbWd1cmwzKXsKICAgICAgICBsZXQgb2JqMSA9IHsKICAgICAgICAgICJpZCI6ICcnLAoJCQkJCSJudW0iOjEsLy/mqKHlnZfkuIAKCQkJCQkic24iOiB0aGlzLm51bTFfc24sLy/mqKHlnZfkuIDnmoTluo/liJflj7cKCQkJCQkicGljIjp0aGlzLmltZ3VybDMvL+WbvgogICAgICAgIH0KICAgICAgICBtb2R1bGUucHVzaChvYmoxKQogICAgICAvLyB9CiAgICAgIC8vIGlmKHRoaXMubnVtMl9zbiAmJiB0aGlzLmltZ3VybDQpewogICAgICAgIGxldCBvYmoyID0gewogICAgICAgICAgImlkIjogJycsCgkJCQkJIm51bSI6MiwvL+aooeWdl+S4gAoJCQkJCSJzbiI6IHRoaXMubnVtMl9zbiwvL+aooeWdl+S4gOeahOW6j+WIl+WPtwoJCQkJCSJwaWMiOnRoaXMuaW1ndXJsNC8v5Zu+CiAgICAgICAgfQogICAgICAgIG1vZHVsZS5wdXNoKG9iajIpCiAgICAgIC8vIH0KICAgICAgLy8gaWYodGhpcy5udW0zX3NuICYmIHRoaXMuaW1ndXJsNSl7CiAgICAgICAgbGV0IG9iajMgPSB7CiAgICAgICAgICAiaWQiOiAnJywKCQkJCQkibnVtIjozLC8v5qih5Z2X5LiACgkJCQkJInNuIjogdGhpcy5udW0zX3NuLC8v5qih5Z2X5LiA55qE5bqP5YiX5Y+3CgkJCQkJInBpYyI6dGhpcy5pbWd1cmw1Ly/lm74KICAgICAgICB9CiAgICAgICAgbW9kdWxlLnB1c2gob2JqMykKICAgICAgLy8gfQogICAgICAvLyBpZih0aGlzLm51bTRfc24gJiYgdGhpcy5pbWd1cmw2KXsKICAgICAgICBsZXQgb2JqNCA9IHsKICAgICAgICAgICJpZCI6ICcnLAoJCQkJCSJudW0iOjQsLy/mqKHlnZfkuIAKCQkJCQkic24iOiB0aGlzLm51bTRfc24sLy/mqKHlnZfkuIDnmoTluo/liJflj7cKCQkJCQkicGljIjp0aGlzLmltZ3VybDYvL+WbvgogICAgICAgIH0KICAgICAgICBtb2R1bGUucHVzaChvYmo0KQogICAgICAvLyB9CiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgaWQ6ICIiLAogICAgICAgIGxhYmVsOiB0aGlzLmxhYmVsX3NuLAogICAgICAgIGluc3RydW1lbnRfU046IHRoaXMuaW5zdHJ1bWVudF9zbiwKICAgICAgICBzbnBpYzogdGhpcy5pbWd1cmwyLAogICAgICAgIGNoYXNzaXNpZDogIiIsCiAgICAgICAgY2hhc3NpczogdGhpcy5jaGFzc2lzX3NuLAogICAgICAgIGNoYXNzaXNwaWM6IHRoaXMuaW1ndXJsLAogICAgICAgIG1vZHVsZTogbW9kdWxlLAogICAgICAgIGluc3RydW1lbnRfbmFtZTogdGhpcy5pbnN0cnVtZW50X25hbWUKICAgICAgfQogICAgICBjb25zb2xlLmxvZygnLS0tLT46JyxwYXJhbXMpCgogICAgICBpZihudW1iZXIgPT0gMSl7CiAgICAgICAgYmluZGluc3RydW1lbnQoewogICAgICAgICAgZGF0YTogcGFyYW1zLAogICAgICAgICAgc3RhdHVzOiAxCiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICBEaWFsb2cuY29uZmlybSh7CiAgICAgICAgICAgICAgdGl0bGU6ICfmoIfpopgnLAogICAgICAgICAgICAgIG1lc3NhZ2U6IHJlcy5kYXRhLm1zZywKICAgICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn6L+U5Zue6aaW6aG1JywKICAgICAgICAgICAgICBjYW5jZWxCdXR0b25Db2xvcjonIzY2NjY2NicsCiAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnu6fnu63nu5HlrponLAogICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogJyMzMDdGRjUnCiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgIHRoYXQubGFiZWxfc249ICIiOwogICAgICAgICAgICAgIHRoYXQuY2hhc3Npc19zbj0gIiI7CiAgICAgICAgICAgICAgdGhhdC5pbnN0cnVtZW50X3NuPSAiIjsKICAgICAgICAgICAgICB0aGF0Lm51bTFfc249ICIiOwogICAgICAgICAgICAgIHRoYXQubnVtMl9zbj0gIiI7CiAgICAgICAgICAgICAgdGhhdC5udW0zX3NuPSAiIjsKICAgICAgICAgICAgICB0aGF0Lm51bTRfc249ICIiOwogICAgICAgICAgICAgIHRoYXQubnVtYmVyTGlzdD0gW10KICAgICAgICAgICAgICB0aGF0LmxhYmxlTGVuZ3RoPSAxOwogICAgICAgICAgICAgIHRoYXQuaXNTaG93PWZhbHNlOwogICAgICAgICAgICAgIHRoYXQubGFiZWxJbmRleD0gLTE7CiAgICAgICAgICAgICAgdGhhdC5pbWd1cmwxPSAiIjsKICAgICAgICAgICAgICB0aGF0LmltZ3VybD0gIiI7CiAgICAgICAgICAgICAgdGhhdC5pbWd1cmwyPSAiIjsKICAgICAgICAgICAgICB0aGF0LmltZ3VybDM9ICIiOwogICAgICAgICAgICAgIHRoYXQuaW1ndXJsND0gIiI7CiAgICAgICAgICAgICAgdGhhdC5pbWd1cmw1PSAiIjsKICAgICAgICAgICAgICB0aGF0LmltZ3VybDY9ICIiOwogICAgICAgICAgICAgIHRoYXQubGFiZWxfc25fb2xkPSAiIjsKICAgICAgICAgICAgICB0aGF0LmNoYXNzaXNfc25fb2xkPSAiIjsKICAgICAgICAgICAgICB0aGF0Lmluc3RydW1lbnRfc25fb2xkPSAiIjsKICAgICAgICAgICAgICB0aGF0Lm51bTFfc25fb2xkPSAiIjsKICAgICAgICAgICAgICB0aGF0Lm51bTJfc25fb2xkPSAiIjsKICAgICAgICAgICAgICB0aGF0Lm51bTNfc25fb2xkPSAiIjsKICAgICAgICAgICAgICB0aGF0Lm51bTRfc25fb2xkPSAiIjsKICAgICAgICAgICAgICB0aGF0Lm51bWJlclR5cGU9ICIwIjsKICAgICAgICAgICAgICB0aGF0LmltZ3VybDFfb2xkPSAiIjsKICAgICAgICAgICAgICB0aGF0LmltZ3VybF9vbGQ9ICIiOwogICAgICAgICAgICAgIHRoYXQuaW1ndXJsMl9vbGQ9ICIiOwogICAgICAgICAgICAgIHRoYXQuaW1ndXJsM19vbGQ9ICIiOwogICAgICAgICAgICAgIHRoYXQuaW1ndXJsNF9vbGQ9ICIiOwogICAgICAgICAgICAgIHRoYXQuaW1ndXJsNV9vbGQ9ICIiOwogICAgICAgICAgICAgIHRoYXQuaW1ndXJsNl9vbGQ9ICIiOwogICAgICAgICAgICAgIHRoYXQuaW5zdHJ1bWVudF9uYW1lID0gIiI7CiAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgICB0aGF0LiRyb3V0ZXIucmVwbGFjZSh7CiAgICAgICAgICAgICAgICAgIHBhdGg6ICIvaW5zdHJ1bWVudExpc3QiLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFRvYXN0KHJlcy5kYXRhLm1zZykKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfWVsc2V7CiAgICAgICAgc2F2ZWluc3RydW1lbnQoewogICAgICAgICAgZGF0YTogcGFyYW1zLAogICAgICAgICAgc3RhdHVzOiAwCiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICB0aGF0LmlzRWRpdCA9IHRydWU7CiAgICAgICAgICAgIFRvYXN0KHJlcy5kYXRhLm1zZykKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFRvYXN0KHJlcy5kYXRhLm1zZykKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIEltYWdlUHJldmlldyhlKXsKICAgICAgbGV0IGltZyA9IGUudGFyZ2V0LmRhdGFzZXQuaW1nOwogICAgICBJbWFnZVByZXZpZXcoW2ltZ10pOwogICAgfSwKICAgIGNhbnZhc0RhdGFVUkwgKHBhdGgsIG9iaiwgY2FsbGJhY2spIHsKICAgICAgbGV0IGltZyA9IG5ldyBJbWFnZSgpCiAgICAgIGltZy5zcmMgPSBwYXRoCiAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgbGV0IHRoYXQgPSB0aGlzIC8vIOaMh+WIsGltZwogICAgICAgIC8vIOm7mOiupOaMieavlOS+i+WOi+e8qQogICAgICAgIGxldCB3ID0gdGhhdC53aWR0aCwKICAgICAgICAgIGggPSB0aGF0LmhlaWdodCwKICAgICAgICAgIHNjYWxlID0gdyAvIGgKICAgICAgICB3ID0gb2JqLndpZHRoIHx8IHcKICAgICAgICBoID0gb2JqLmhlaWdodCB8fCAodyAvIHNjYWxlKQogICAgICAgIHcgPSB3ID49IDQwOTYgPyA0MDk2IDogdwogICAgICAgIGggPSBoID49IDQwOTYgPyA0MDk2IDogaAogICAgICAgIGNvbnNvbGUubG9nKG9iai5oZWlnaHQsdyxoLHNjYWxlKQogICAgICAgIGxldCBxdWFsaXR5ID0gMC41IC8vIOm7mOiupOWbvueJh+i0qOmHj+S4ujAuNwogICAgICAgIC8vIOeUn+aIkGNhbnZhcwogICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKQogICAgICAgIGxldCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKQogICAgICAgIC8vIOWIm+W7uuWxnuaAp+iKgueCuQogICAgICAgIGxldCBhbncgPSBkb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUoJ3dpZHRoJykKICAgICAgICBhbncubm9kZVZhbHVlID0gdwogICAgICAgIGxldCBhbmggPSBkb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUoJ2hlaWdodCcpCiAgICAgICAgYW5oLm5vZGVWYWx1ZSA9IGgKICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlTm9kZShhbncpCiAgICAgICAgY2FudmFzLnNldEF0dHJpYnV0ZU5vZGUoYW5oKQogICAgICAgIGN0eC5kcmF3SW1hZ2UodGhhdCwgMCwgMCwgdywgaCkKICAgICAgICAvLyDlm77lg4/otKjph48KICAgICAgICBpZiAob2JqLnF1YWxpdHkgJiYgb2JqLnF1YWxpdHkgPj0gMSAmJiBvYmoucXVhbGl0eSA8IDApIHsKICAgICAgICAgIHF1YWxpdHkgPSBvYmoucXVhbGl0eQogICAgICAgIH0KICAgICAgICAvLyBxdWFsaXR55YC86LaK5bCP77yM5omA57uY5Yi25Ye655qE5Zu+5YOP6LaK5qih57OKCiAgICAgICAgbGV0IGJhc2U2NCA9IGNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL2pwZWcnLCBxdWFsaXR5KQogICAgICAgIC8vIOWbnuiwg+WHveaVsOi/lOWbnmJhc2U2NOeahOWAvAogICAgICAgIGNhbGxiYWNrKGJhc2U2NCkKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["instrumentBind.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0PA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"instrumentBind.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <div class=\"child-section\">\n    <Header>\n      <div class=\"header-content\">\n        <div class=\"header-title\">绑定仪器</div>\n        <div class=\"header-back\">\n          <div class=\"back\" @click=\"handleTitleBack\">\n            <img class=\"icon_logo\" src=\"../assets/images/close.png\" alt=\"\" />\n          </div>\n        </div>\n      </div>\n    </Header>\n   \n    <div class=\"bind_main\">\n      <div class=\"bind_main_item\">\n        <div class=\"icon_login_text\">耳环编号</div>\n        <div class=\"form-item\">\n          <div class=\"select-item input-item\">\n            <input\n              v-model=\"label_sn\"\n              type=\"text\"\n              name=\"label_sn\"\n              placeholder=\"请填写/扫描耳环编号\"\n              :disabled=\"isEdit\"\n            />\n            <div class=\"pic-div\"  @click=\"OnQRcode\">\n                <img class=\"pic-img-item\" id=\"img1\">\n                  <img class=\"pic-img-icon\" src=\"../assets/images/icon_scan.png\" alt=\"\" />\n                  <!-- <input class=\"img-item\" type=\"file\" accept=\"image/*\" id=\"uploadImg1\" name=\"uploadImg1\" alt=\"\" @change=\"handleFileImg1\" /> -->\n                </img>\n              </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"bind_main_item\">\n        <div class=\"icon_login_text\">仪器信息</div>\n        <div class=\"drop-select-item\">\n          <DropDownList\n              :dataList=\"instrumentList\"\n              @change=\"onInstrumentChange\"\n              align=\"left\"\n              class=\"select\"\n              placeholder=\"请选择仪器类型\"\n            />\n        </div>\n        <div class=\"form-item\" style=\"border-bottom: none;margin-top:5px;\">\n          <div class=\"select-item input-item\">\n            <input\n              v-model=\"instrument_sn\"\n              type=\"text\"\n              name=\"instrument_sn\"\n              placeholder=\"请填写/扫描仪器SN号\"\n              :disabled=\"isEdit\"/>\n            <div class=\"pic-div\">\n                <img class=\"pic-img-item\" id=\"img2\">\n                  <img class=\"pic-img-icon\" src=\"../assets/images/camera.png\" alt=\"\" />\n                  <input class=\"img-item\" :disabled=\"isEdit\" type=\"file\" accept=\"image/*\" id=\"uploadImg2\" name=\"uploadImg2\" alt=\"\" @change=\"handleFileImg2\"/>\n                </img>\n              </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- <div class=\"bind_main_item\">\n        <div class=\"icon_login_text\">仪器序列号</div>\n        <div class=\"form-item\" style=\"border-bottom: none;\">\n          <div class=\"select-item input-item\">\n            <input\n              v-model=\"instrument_sn\"\n              type=\"text\"\n              name=\"instrument_sn\"\n              placeholder=\"请填写/扫描仪器SN号\"\n              :disabled=\"isEdit\"/>\n            <div class=\"pic-div\">\n                <img class=\"pic-img-item\" id=\"img2\">\n                  <img class=\"pic-img-icon\" src=\"../assets/images/camera.png\" alt=\"\" />\n                  <input class=\"img-item\" :disabled=\"isEdit\" type=\"file\" accept=\"image/*\" id=\"uploadImg2\" name=\"uploadImg2\" alt=\"\" @change=\"handleFileImg2\"/>\n                </img>\n              </div>\n          </div>\n        </div>\n      </div> -->\n\n      <div class=\"bind_main_item\">\n        <div class=\"icon_login_text\">机芯编号(选填)</div>\n        <div class=\"form-item\" style=\"border-bottom: none;\">\n          <div class=\"select-item input-item\">\n            <input\n              v-model=\"chassis_sn\"\n              type=\"text\"\n              name=\"chassis_sn\"\n              placeholder=\"请填写/扫描机芯编号\"\n              :disabled=\"isEdit\"/>\n            <div class=\"pic-div\">\n                <img class=\"pic-img-item\" id=\"img\">\n                  <img class=\"pic-img-icon\" src=\"../assets/images/camera.png\" alt=\"\" />\n                  <input class=\"img-item\" :disabled=\"isEdit\" type=\"file\" accept=\"image/*\" id=\"uploadImg\" name=\"uploadImg\" alt=\"\" @change=\"handleFileImg\" />\n                </img>\n              </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"bind_main_item\">\n        <div class=\"icon_login_text\">模块信息(选填)</div>\n        <div class=\"form-item\" style=\"padding: 8px 0px;border-bottom: 1px solid #DDDDDD;\">\n          <div class=\"select-item input-item\">\n            <input\n              v-model=\"num1_sn\"\n              type=\"text\"\n              name=\"num1_sn\"\n              placeholder=\"模块1编号\"\n              :disabled=\"isEdit\"/>\n            <div class=\"pic-div\">\n                <img class=\"pic-img-item\" id=\"img3\">\n                  <img class=\"pic-img-icon\" src=\"../assets/images/camera.png\" alt=\"\" />\n                  <input class=\"img-item\" :disabled=\"isEdit\" type=\"file\" accept=\"image/*\" id=\"uploadImg3\" name=\"uploadImg3\" alt=\"\" @change=\"handleFileImg3\"/>\n                </img>\n              </div>\n          </div>\n        </div>\n        <div class=\"form-item\" style=\"padding: 8px 0px;border-bottom: 1px solid #DDDDDD;\">\n          <div class=\"select-item input-item\">\n            <input\n              v-model=\"num2_sn\"\n              type=\"text\"\n              name=\"num2_sn\"\n              placeholder=\"模块2编号\"\n              :disabled=\"isEdit\"/>\n            <div class=\"pic-div\">\n                <img class=\"pic-img-item\" id=\"img4\">\n                  <img class=\"pic-img-icon\" src=\"../assets/images/camera.png\" alt=\"\" />\n                  <input class=\"img-item\" :disabled=\"isEdit\" type=\"file\" accept=\"image/*\" id=\"uploadImg4\" name=\"uploadImg4\" alt=\"\" @change=\"handleFileImg4\"/>\n                </img>\n              </div>\n          </div>\n        </div>\n        <div class=\"form-item\" style=\"padding: 8px 0px;border-bottom: 1px solid #DDDDDD;\">\n          <div class=\"select-item input-item\">\n            <input\n              v-model=\"num3_sn\"\n              type=\"text\"\n              name=\"num3_sn\"\n              placeholder=\"模块3编号\"\n              :disabled=\"isEdit\"/>\n            <div class=\"pic-div\">\n                <img class=\"pic-img-item\" id=\"img5\">\n                  <img class=\"pic-img-icon\" src=\"../assets/images/camera.png\" alt=\"\" />\n                  <input class=\"img-item\" :disabled=\"isEdit\" type=\"file\" accept=\"image/*\" id=\"uploadImg5\" name=\"uploadImg5\" alt=\"\" @change=\"handleFileImg5\"/>\n                </img>\n              </div>\n          </div>\n        </div>\n        <div class=\"form-item\" style=\"padding: 8px 0px 0px 0px;\">\n          <div class=\"select-item input-item\">\n            <input\n              v-model=\"num4_sn\"\n              type=\"text\"\n              name=\"num4_sn\"\n              placeholder=\"模块4编号\"\n              :disabled=\"isEdit\"/>\n            <div class=\"pic-div\">\n                <img class=\"pic-img-item\" id=\"img6\">\n                  <img class=\"pic-img-icon\" src=\"../assets/images/camera.png\" alt=\"\" />\n                  <input class=\"img-item\" :disabled=\"isEdit\" type=\"file\" accept=\"image/*\" id=\"uploadImg6\" name=\"uploadImg6\" alt=\"\" @change=\"handleFileImg6\"/>\n                </img>\n              </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"bind_main_item\">\n        <div class=\"icon_login_text\">图片记录</div>\n        <div class=\"form-item\" style=\"border-bottom: none;\">\n          <div class=\"img_1_view\">\n            <img class=\"img_1\" v-if=\"imgurl2\" :src=\"imgurl2\" alt=\"\" @click=\"ImagePreview\" :data-img=\"imgurl2\"/>\n            <div class=\"img_1\" v-else></div>\n            <div class=\"img_1_text\">仪器序列号</div>\n          </div>\n          <div class=\"img_1_view\">\n            <img class=\"img_1\" v-if=\"imgurl\" :src=\"imgurl\" alt=\"\" @click=\"ImagePreview\" :data-img=\"imgurl\"/>\n            <div class=\"img_1\" v-else></div>\n            <div class=\"img_1_text\">机芯编号</div>\n          </div>\n          <div class=\"img_1_view\">\n            <img class=\"img_1\" v-if=\"imgurl3\" :src=\"imgurl3\" alt=\"\" @click=\"ImagePreview\" :data-img=\"imgurl3\"/>\n            <div class=\"img_1\" v-else></div>\n            <div class=\"img_1_text\">模块1</div>\n          </div>\n          <div class=\"img_1_view\">\n           <img class=\"img_1\" v-if=\"imgurl4\" :src=\"imgurl4\" alt=\"\" @click=\"ImagePreview\" :data-img=\"imgurl4\"/>\n            <div class=\"img_1\" v-else></div>\n            <div class=\"img_1_text\">模块2</div>\n          </div>\n          <div class=\"img_1_view\">\n            <img class=\"img_1\" v-if=\"imgurl5\" :src=\"imgurl5\" alt=\"\" @click=\"ImagePreview\" :data-img=\"imgurl5\"/>\n            <div class=\"img_1\" v-else></div>\n            <div class=\"img_1_text\">模块3</div>\n          </div>\n        </div>\n        <div class=\"form-item\" style=\"border-bottom: none;padding-left: 6px;\">\n          <div class=\"img_1_view\">\n            <img class=\"img_1\" v-if=\"imgurl6\" :src=\"imgurl6\" alt=\"\" @click=\"ImagePreview\" :data-img=\"imgurl6\"/>\n            <div class=\"img_1\" v-else></div>\n            <div class=\"img_1_text\">模块4</div>\n          </div>\n\n        </div>\n      </div>\n      <div class=\"empty_view\"></div>\n      <div class=\"view_bottom\" v-if=\"roleId == 2\">\n        <div class=\"view_bottom_left\" @click=\"bindInstrument\" :data-number=\"0\">保存</div>\n        <div class=\"view_bottom_right\" @click=\"bindInstrument\" :data-number=\"1\">确认绑定</div>\n      </div>\n\n      <!-- <div class=\"view_bottom\" v-if=\"roleId == 1\">\n          <div class=\"submit_view\" @click=\"bindInstrument\">确认绑定</div>\n      </div> -->\n\n    </div>\n    \n    <van-dialog\n            v-model=\"isShow\"\n            show-cancel-button\n            :beforeClose=\"beforeClose\"\n            confirmButtonColor='#307FF5'\n    >\n    <div style=\"height: 300px;overflow: auto;margin: 30px 30px 10px;\">\n        <div\n            class=\"dialog_item\"\n            v-for=\"(item, index) in numberList\"\n            :key=\"index\"\n            @click=\"bindSelect\"\n            :data-linecontent=\"item.line_content\"\n            :data-index=\"index\">\n            <div @click=\"bindSelect\"\n            :data-linecontent=\"item.line_content\"\n            :data-index=\"index\">{{item.line_content}}</div>\n            <img v-if=\"labelIndex == index\" style=\"width:20px;height:20px;\" src=\"../assets/images/icon_selected.png\" alt=\"\" />\n        </div>\n    </div>\n \n    </van-dialog>\n\n  </div>\n</template>\n\n\n<script>\n/**\n * 注: 此页面只为移动端服务, 在pc模式下会导致页面失去比例\n * h5页\n */\n\nimport Header from \"../components/header.vue\";\nimport { udateH5Images,uploadImgSelect,uploadImgBind ,bindinstrument, getJSSDKHELP,saveinstrument,getBindbutn,searchSN} from \"../request/api\";\n// import { Notify } from \"vant\";\nimport { Button,Dialog ,Uploader,Toast,ImagePreview,Loading} from 'vant';\nimport wx from 'jweixin-module';\nimport DropDownList from \"../components/mg_select.vue\";\n\nvar imgurl1= ''\nvar imgurl= ''\n var imgurl2= ''\n var imgurl3= ''\n  var imgurl4= ''\n var imgurl5= ''\nvar imgurl6= ''\n\nexport default {\n  name: \"\",\n  components: {\n    Header,\n    [Dialog.Component.name]: Dialog.Component, //Dialog.Component写成这样才生效\n    [Button.name]: Button,\n    Uploader,\n    DropDownList\n  },\n  data() {\n    return {\n      isShowInstrument: true,\n      instrumentList:[\n        {\n          'instrument_name': 'mini8'\n        },\n        {\n          'instrument_name': 'flash20'\n        },\n        {\n          'instrument_name': 'mini8'\n        }\n      ],\n      instrumentIndex: -1,\n      instrument_name:\"\",\n      roleId: 1,  // 1--库管   2--生产  3--维修\n      label_sn: \"\",\n      chassis_sn: \"\",\n      instrument_sn: \"\",\n      num1_sn: \"\",\n      num2_sn: \"\",\n      num3_sn: \"\",\n      num4_sn: \"\",\n      numberList: [],\n      lableLength: 1,\n      isShow: false,\n      labelIndex: -1,\n      imgurl1: '',\n      imgurl: '',\n      imgurl2: '',\n      imgurl3: '',\n      imgurl4: '',\n      imgurl5: '',\n      imgurl6: '',\n      label_sn_old: '',\n      chassis_sn_old: '',\n      instrument_sn_old: \"\",\n      num1_sn_old: \"\",\n      num2_sn_old: \"\",\n      num3_sn_old: \"\",\n      num4_sn_old: \"\",\n      numberType: \"0\",\n      imgurl1_old: '',\n      imgurl_old: '',\n      imgurl2_old: '',\n      imgurl3_old: '',\n      imgurl4_old: '',\n      imgurl5_old: '',\n      imgurl6_old: '',\n      isEdit: false\n    };\n  },\n  activated() {\n    this.roleId = this.$route.query.id;\n    console.log(this.roleId)\n  },\n  mounted() {\n    this.isWechat();\n  },\n  methods: {\n    onInstrumentChange(val) {\n      let code = val.value.instrument_name;\n      console.log(code)\n      this.instrument_name = code;\n    },\n    // 首页上的绑定按钮 获取生产保存数据\n    getBindbutn(){\n      getBindbutn({}).then((res)=>{\n        if (res.data.success) {\n          console.log('--getBindbutn-->:',res)\n        } else {\n          Toast(res.data.msg)\n        }\n      });\n    },\n    isWechat() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      if (ua.match(/micromessenger/i) == 'micromessenger') {\n        // return true;\n        console.log('微信浏览器');\n        this.scanQRJssdk();\n      } else {\n        console.log('普通浏览器,请在手机微信浏览器打开此页面');\n        return false;\n      }\n    },\n    // 初始化sdk配置\n    async scanQRJssdk() {\n      // alert(`url链接:${window.location.href}`);\n\t  const u = navigator.userAgent;\n      const isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; // Android\n      const isIOS = navigator.platform.indexOf('iPhone') != -1;//ios\n       let url = '';\n      if (isAndroid) {\n        url = location.href;\n      }\n      if (isIOS) {\n        url = location.href.split('#')[0]; // hash模式下,#后面的部分如果带上ios中config会不对\n      }\n      const api = [];\n      // 'qrCode','barCode'\n      api.push('qrCode');\n      api.push('barCode');\n      // alert(url);\n      const resData = await getJSSDKHELP({ url });\t// 根据接口返回appId，timestamp等数据\n      console.log('获取微信配置结果', resData);\n      if (resData) {\n        // alert(JSON.stringify(resData.data));\n        wx.config({\n          // beta: true,\n          debug: false,\n          appId: resData.data.appId,\n          timestamp: resData.data.timestamp,\n          nonceStr: resData.data.nonceStr,\n          signature: resData.data.signature,\n          jsApiList: ['checkJsApi', 'scanQRCode']\n        });\n        wx.ready(() => {\n          wx.checkJsApi({\n            jsApiList: ['scanQRCode'],\n            success(res) {\n              console.log('aaaa', res);\n            }\n          });\n        });\n        wx.error((res) => {\n          alert(`出错了：${res.errMsg}`);// 这个地方的好处就是wx.config配置错误，会弹出窗口哪里错误，然\t\t后根据微信文档查询即可。\n        });\n      }\n    },\n    OnQRcode() {\t// 点击的时候调起扫一扫功能呢\n      if(this.isEdit){\n\n      }else{\n        const that = this;\n        wx.scanQRCode({\n          needResult: 1, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，\n          scanType: ['qrCode', 'barCode'], // 可以指定扫二维码还是一维码，默认二者都有\n          success(res) {\n            const resultStrArr = res.resultStr.split(',');\t\t\n            // 转为数组时为了避免扫描一维码是返回CODE_128,20180528前面会添加一个CODE_128所以转为数组获\t\t取最后一条就行了\n            console.log(resultStrArr[resultStrArr.length - 1]); // 输出扫码信息\n            that.result = resultStrArr[resultStrArr.length - 1];\n            that.label_sn = resultStrArr[resultStrArr.length - 1];\n          },\n          fail(res) {\n            console.log('err', res);\n          }\n        });\n      }\n    },\n     handleTitleBack() {\n      this.$router.back();\n    },\n    bindSelect(e){\n      this.labelIndex = e.target.dataset.index;\n      if(this.numberType == 1){\n        this.label_sn_old = e.target.dataset.linecontent;\n      }\n\n      if(this.numberType == 0){\n        this.chassis_sn_old = e.target.dataset.linecontent;\n      }\n      \n      if(this.numberType == 2){\n        this.instrument_sn_old = e.target.dataset.linecontent;\n      }\n\n      if(this.numberType == 3){\n        this.num1_sn_old = e.target.dataset.linecontent;\n      }\n\n      if(this.numberType == 4){\n        this.num2_sn_old = e.target.dataset.linecontent;\n      }\n                     \n      if(this.numberType == 5){\n        this.num3_sn_old = e.target.dataset.linecontent;\n      }\n\n      if(this.numberType == 6){\n        this.num4_sn_old = e.target.dataset.linecontent;\n      }\n    },\n    beforeClose(action, done) {\n      let that = this;\n                if(action === 'confirm') {\n                  if(this.numberType == 1){\n                        this.label_sn = this.label_sn_old;\n                        this.imgurl1 = this.imgurl1_old;\n                     }\n                   \n                   if(this.numberType == 0){\n                      searchSN({\n                         type: '0',\n                         SN: this.chassis_sn_old\n                       }).then((res)=>{\n                         if (res.data.success) {\n                            that.chassis_sn = that.chassis_sn_old;\n                            that.imgurl = that.imgurl_old;\n                          } else {\n                            Toast(res.data.msg)\n                          }\n                       })\n                     }\n                     if(this.numberType == 2){\n                       searchSN({\n                         type: '0',\n                         SN: this.instrument_sn_old\n                       }).then((res)=>{\n                         if (res.data.success) {\n                            that.instrument_sn = that.instrument_sn_old;\n                            that.imgurl2 = that.imgurl2_old;\n                          } else {\n                            Toast(res.data.msg)\n                          }\n                       })\n                     }\n                     if(this.numberType == 3){\n                       searchSN({\n                         type: '1',\n                         SN: this.num1_sn_old\n                       }).then((res)=>{\n                         if (res.data.success) {\n                            that.num1_sn = that.num1_sn_old;\n                            that.imgurl3 = that.imgurl3_old;\n                          } else {\n                            Toast(res.data.msg)\n                          }\n                       })\n                     }\n                     if(this.numberType == 4){\n                       searchSN({\n                         type: '1',\n                         SN: this.num2_sn_old\n                       }).then((res)=>{\n                         if (res.data.success) {\n                            that.num2_sn = that.num2_sn_old;\n                            that.imgurl4 = that.imgurl4_old;\n                          } else {\n                            Toast(res.data.msg)\n                          }\n                       })\n                     }\n                     if(this.numberType == 5){\n                       searchSN({\n                         type: '1',\n                         SN: this.num3_sn_old\n                       }).then((res)=>{\n                         if (res.data.success) {\n                            that.num3_sn = that.num3_sn_old;\n                       that.imgurl5 = that.imgurl5_old;\n                          } else {\n                            Toast(res.data.msg)\n                          }\n                       })\n                       \n                     }\n                     if(this.numberType == 6){\n                       searchSN({\n                         type: '1',\n                         SN: this.num4_sn_old\n                       }).then((res)=>{\n                         if (res.data.success) {\n                           that.num4_sn = that.num4_sn_old;\n                       that.imgurl6 = that.imgurl6_old;\n                          } else {\n                            Toast(res.data.msg)\n                          }\n                       })\n                       \n                     }\n                   done()\n                } else if(action === 'cancel') {\n                  this.chassis_sn = '';\n                  this.labelIndex = -1;\n                    done() //关闭\n                }\n    },\n    setPicImg(value,number){\n       \n      let that = this;\n      if(value){\n        \n       Toast.loading({\n         duration: 2000, // 持续展示 toast\n         forbidClick: true,\n         message: \"加载中...\"\n     });\n\n        let start = value.indexOf(',') + 1;\n                  let dataurl = value.substr(start);\n                   uploadImgBind({\n                     'image_64': dataurl,\n                   }).then((res)=>{\n                      if (res.data.success) {\n                        if(number == 1){\n                          that.imgurl1_old = res.data.msg\n                        }\n                        if(number == 0){\n                          that.imgurl_old = res.data.msg\n                        }\n                        if(number == 2){\n                          that.imgurl2_old = res.data.msg\n                        }\n                        if(number == 3){\n                          that.imgurl3_old = res.data.msg\n                        }\n                        if(number == 4){\n                          that.imgurl4_old = res.data.msg\n                        }\n                        if(number == 5){\n                          that.imgurl5_old = res.data.msg\n                        }\n                        if(number == 6){\n                          that.imgurl6_old = res.data.msg\n                        }\n                      } else {\n                        Toast(res.data.msg)\n                      }\n                   }).catch((err)=>{\n                      Toast(err)\n                   })\n\n                  udateH5Images({\n                    'image_base64':value,\n                      'api_key': 'gQfz-MnGIuRUbtzJK8wB_x1ZVEc45J0H', //请填写你创建的 apikey\n                      'api_secret': 'GNl9vID_5KjzzbG2UG51vswvYeb06vnu',\n                  }).then((res)=>{\n                    console.log(res)\n                      that.numberList = res.data.text_info;\n                    \n                    let numberListNew = [];\n                    let reg = /[^a-z\\d]/ig;\n                    for(let i =0;i< that.numberList.length;i++){\n                      let item = that.numberList[i];\n                      if(item.line_content!= null && item.line_content != \"\"){\n                        if(item.line_content.indexOf(\":\") >=0 || item.line_content.indexOf(\"：\")>=0){\n                          item.line_content = item.line_content.split(\":\")[1] || item.line_content.split(\"：\")[1];\n                          item.line_content = item.line_content.replace(reg, \"\")\n                        }else{\n                          item.line_content = item.line_content.replace(reg, \"\")\n                        }\n                        if(item.line_content.length >= that.lableLength){\n                          numberListNew.push(item);\n                        }\n                      }  \n                    }\n                    that.numberList = numberListNew\n                      if(that.numberList.length> 0){\n                        that.labelIndex= -1;\n                        that.isShow = true;\n                        that.numberType = number;\n                      }\n                   \n                  });\n      }\n    },\n    handleFileImg1() {\n      let that = this;\n      let uploadImg = document.getElementById('uploadImg1')\n    // 为了获取图片的本地路径\n        window.URL = window.URL || window.webkitURL;\n    // 获取移动端类型Android   iPhone  ipad\n        let sUserAgent = navigator.userAgent.toLowerCase();\n    // 获取当前图片信息（单张图片上传）\n        let selected_file = uploadImg.files[0];\n        console.log(selected_file);\n        if (sUserAgent.match(/android/i) == \"android\") {\n          let img1 = document.getElementById('img1');\n            let img = new Image();\n    \t    // 生成一个本地图片展示路径\n            img.src = window.URL.createObjectURL(selected_file);\n            let reader = new FileReader();//简单来说就是异步读取电脑中的文件\n            reader.onload = function (e) {\n                imgurl1 = e.target.result;\n\n                if(e.target.result.length / 1024 > 1025){\n                  that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                    that.setPicImg(base64Codes,1);\n                  });\n                }else{\n                  that.setPicImg(e.target.result,1);\n                }\n            };\n            img1.src = window.URL.createObjectURL(selected_file);\n            reader.readAsDataURL(selected_file);\n        } else {\n            if(selected_file){\n              //判断文件类型是否为图片\n              if (!selected_file.type.match(/image.*/)) return false;\n              let img = document.getElementById('img1');\n              // base64赋值\n              img.file = selected_file;\n              img.onload = function () {\n                  imgurl1 = img.src;\n              };\n              let reader = new FileReader();\n              reader.onload = function (e) {\n                  img.src = e.target.result;\n                  imgurl1 = img.src;\n\n                  if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,1);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,1);\n                  }\n                \n              };\n              reader.readAsDataURL(selected_file);\n            }\n        }\n    },\n    handleFileImg() {\n      let that = this;\n      let uploadImg = document.getElementById('uploadImg')\n    // 为了获取图片的本地路径\n        window.URL = window.URL || window.webkitURL;\n    // 获取移动端类型Android   iPhone  ipad\n        let sUserAgent = navigator.userAgent.toLowerCase();\n    // 获取当前图片信息（单张图片上传）\n        let selected_file = uploadImg.files[0];\n        console.log(selected_file);\n        if (sUserAgent.match(/android/i) == \"android\") {\n          let img1 = document.getElementById('img');\n            let img = new Image();\n    \t    // 生成一个本地图片展示路径\n            img.src = window.URL.createObjectURL(selected_file);\n            let reader = new FileReader();//简单来说就是异步读取电脑中的文件\n            reader.onload = function (e) {\n                imgurl = e.target.result;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,0);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,0);\n                  }\n            };\n            img1.src = window.URL.createObjectURL(selected_file);\n            reader.readAsDataURL(selected_file);\n        } else {\n            if(selected_file){\n              //判断文件类型是否为图片\n              if (!selected_file.type.match(/image.*/)) return false;\n              let img = document.getElementById('img');\n              // base64赋值\n              img.file = selected_file;\n              img.onload = function () {\n                  imgurl = img.src;\n              };\n              let reader = new FileReader();\n              reader.onload = function (e) {\n                  img.src = e.target.result;\n                  imgurl = img.src;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,0);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,0);\n                  }\n              };\n              reader.readAsDataURL(selected_file);\n            }\n        }\n    },\n     handleFileImg2() {\n      let that = this;\n      let uploadImg = document.getElementById('uploadImg2')\n    // 为了获取图片的本地路径\n        window.URL = window.URL || window.webkitURL;\n    // 获取移动端类型Android   iPhone  ipad\n        let sUserAgent = navigator.userAgent.toLowerCase();\n    // 获取当前图片信息（单张图片上传）\n        let selected_file = uploadImg.files[0];\n        console.log(selected_file);\n        if (sUserAgent.match(/android/i) == \"android\") {\n          let img1 = document.getElementById('img2');\n            let img = new Image();\n    \t    // 生成一个本地图片展示路径\n            img.src = window.URL.createObjectURL(selected_file);\n            let reader = new FileReader();//简单来说就是异步读取电脑中的文件\n            reader.onload = function (e) {\n                imgurl2 = e.target.result;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,2);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,2);\n                  }\n            };\n            img1.src = window.URL.createObjectURL(selected_file);\n            reader.readAsDataURL(selected_file);\n        } else {\n            if(selected_file){\n              //判断文件类型是否为图片\n              if (!selected_file.type.match(/image.*/)) return false;\n              let img = document.getElementById('img2');\n              // base64赋值\n              img.file = selected_file;\n              img.onload = function () {\n                  imgurl2 = img.src;\n              };\n              let reader = new FileReader();\n              reader.onload = function (e) {\n                  img.src = e.target.result;\n                  imgurl2 = img.src;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,2);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,2);\n                  }\n              };\n              reader.readAsDataURL(selected_file);\n            }\n        }\n    },\n     handleFileImg3() {\n      let that = this;\n      let uploadImg = document.getElementById('uploadImg3')\n    // 为了获取图片的本地路径\n        window.URL = window.URL || window.webkitURL;\n    // 获取移动端类型Android   iPhone  ipad\n        let sUserAgent = navigator.userAgent.toLowerCase();\n    // 获取当前图片信息（单张图片上传）\n        let selected_file = uploadImg.files[0];\n        console.log(selected_file);\n        if (sUserAgent.match(/android/i) == \"android\") {\n          let img1 = document.getElementById('img3');\n            let img = new Image();\n    \t    // 生成一个本地图片展示路径\n            img.src = window.URL.createObjectURL(selected_file);\n            let reader = new FileReader();//简单来说就是异步读取电脑中的文件\n            reader.onload = function (e) {\n                imgurl3 = e.target.result;\n\n               if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,3);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,3);\n                  }\n                \n            };\n            img1.src = window.URL.createObjectURL(selected_file);\n            reader.readAsDataURL(selected_file);\n        } else {\n            if(selected_file){\n              //判断文件类型是否为图片\n              if (!selected_file.type.match(/image.*/)) return false;\n              let img = document.getElementById('img3');\n              // base64赋值\n              img.file = selected_file;\n              img.onload = function () {\n                  imgurl3 = img.src;\n              };\n              let reader = new FileReader();\n              reader.onload = function (e) {\n                  img.src = e.target.result;\n                  imgurl3 = img.src;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,3);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,3);\n                  }\n                  \n              };\n              reader.readAsDataURL(selected_file);\n            }\n        }\n    },\n     handleFileImg4() {\n      let that = this;\n      let uploadImg = document.getElementById('uploadImg4')\n    // 为了获取图片的本地路径\n        window.URL = window.URL || window.webkitURL;\n    // 获取移动端类型Android   iPhone  ipad\n        let sUserAgent = navigator.userAgent.toLowerCase();\n    // 获取当前图片信息（单张图片上传）\n        let selected_file = uploadImg.files[0];\n        console.log(selected_file);\n        if (sUserAgent.match(/android/i) == \"android\") {\n          let img1 = document.getElementById('img4');\n            let img = new Image();\n    \t    // 生成一个本地图片展示路径\n            img.src = window.URL.createObjectURL(selected_file);\n            let reader = new FileReader();//简单来说就是异步读取电脑中的文件\n            reader.onload = function (e) {\n                imgurl4 = e.target.result;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,4);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,4);\n                  }\n                \n            };\n            img1.src = window.URL.createObjectURL(selected_file);\n            reader.readAsDataURL(selected_file);\n        } else {\n            if(selected_file){\n              //判断文件类型是否为图片\n              if (!selected_file.type.match(/image.*/)) return false;\n              let img = document.getElementById('img4');\n              // base64赋值\n              img.file = selected_file;\n              img.onload = function () {\n                  imgurl4 = img.src;\n              };\n              let reader = new FileReader();\n              reader.onload = function (e) {\n                  img.src = e.target.result;\n                  imgurl4 = img.src;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,4);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,4);\n                  }\n              };\n              reader.readAsDataURL(selected_file);\n            }\n        }\n    },\n     handleFileImg5() {\n      let that = this;\n      let uploadImg = document.getElementById('uploadImg5')\n    // 为了获取图片的本地路径\n        window.URL = window.URL || window.webkitURL;\n    // 获取移动端类型Android   iPhone  ipad\n        let sUserAgent = navigator.userAgent.toLowerCase();\n    // 获取当前图片信息（单张图片上传）\n        let selected_file = uploadImg.files[0];\n        console.log(selected_file);\n        if (sUserAgent.match(/android/i) == \"android\") {\n          let img1 = document.getElementById('img5');\n            let img = new Image();\n    \t    // 生成一个本地图片展示路径\n            img.src = window.URL.createObjectURL(selected_file);\n            let reader = new FileReader();//简单来说就是异步读取电脑中的文件\n            reader.onload = function (e) {\n                imgurl5 = e.target.result;\n                \n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,5);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,5);\n                  }\n                \n            };\n            img1.src = window.URL.createObjectURL(selected_file);\n            reader.readAsDataURL(selected_file);\n        } else {\n            if(selected_file){\n              //判断文件类型是否为图片\n              if (!selected_file.type.match(/image.*/)) return false;\n              let img = document.getElementById('img5');\n              // base64赋值\n              img.file = selected_file;\n              img.onload = function () {\n                  imgurl5 = img.src;\n              };\n              let reader = new FileReader();\n              reader.onload = function (e) {\n                  img.src = e.target.result;\n                  imgurl5 = img.src;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,5);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,5);\n                  }\n                  \n              };\n              reader.readAsDataURL(selected_file);\n            }\n        }\n    },\n     handleFileImg6() {\n      let that = this;\n      let uploadImg = document.getElementById('uploadImg6')\n    // 为了获取图片的本地路径\n        window.URL = window.URL || window.webkitURL;\n    // 获取移动端类型Android   iPhone  ipad\n        let sUserAgent = navigator.userAgent.toLowerCase();\n    // 获取当前图片信息（单张图片上传）\n        let selected_file = uploadImg.files[0];\n        console.log(selected_file);\n        if (sUserAgent.match(/android/i) == \"android\") {\n          let img1 = document.getElementById('img6');\n            let img = new Image();\n    \t    // 生成一个本地图片展示路径\n            img.src = window.URL.createObjectURL(selected_file);\n            let reader = new FileReader();//简单来说就是异步读取电脑中的文件\n            reader.onload = function (e) {\n                imgurl6 = e.target.result;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,6);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,6);\n                  }\n            };\n            img1.src = window.URL.createObjectURL(selected_file);\n            reader.readAsDataURL(selected_file);\n        } else {\n            if(selected_file){\n              //判断文件类型是否为图片\n              if (!selected_file.type.match(/image.*/)) return false;\n              let img = document.getElementById('img6');\n              // base64赋值\n              img.file = selected_file;\n              img.onload = function () {\n                  imgurl6 = img.src;\n              };\n              let reader = new FileReader();\n              reader.onload = function (e) {\n                  img.src = e.target.result;\n                  imgurl6 = img.src;\n\n                if(e.target.result.length / 1024 > 1025){\n                    that.canvasDataURL(e.target.result, {quality: 0.7}, function (base64Codes) {\n                      that.setPicImg(base64Codes,6);\n                    });\n                  }else{\n                    that.setPicImg(e.target.result,6);\n                  }\n              };\n              reader.readAsDataURL(selected_file);\n            }\n        }\n    },\n    bindInstrument(e) {\n      let number = e.target.dataset.number;\n      let that = this;\n      if (this.label_sn == '') {\n        Toast('耳环编号不能为空');\n        return;\n      }\n      if (this.instrument_name == '') {\n        Toast('请选择仪器名称');\n        return;\n      }\n      \n      if (this.instrument_SN == '') {\n        Toast('仪器序列号不能为空');\n        return;\n      }\n      // if (this.chassis == '') {\n      //   Toast('机芯序列号不能为空');\n      //   return;\n      // }\n      let module = []\n      // if(this.num1_sn && this.imgurl3){\n        let obj1 = {\n          \"id\": '',\n\t\t\t\t\t\"num\":1,//模块一\n\t\t\t\t\t\"sn\": this.num1_sn,//模块一的序列号\n\t\t\t\t\t\"pic\":this.imgurl3//图\n        }\n        module.push(obj1)\n      // }\n      // if(this.num2_sn && this.imgurl4){\n        let obj2 = {\n          \"id\": '',\n\t\t\t\t\t\"num\":2,//模块一\n\t\t\t\t\t\"sn\": this.num2_sn,//模块一的序列号\n\t\t\t\t\t\"pic\":this.imgurl4//图\n        }\n        module.push(obj2)\n      // }\n      // if(this.num3_sn && this.imgurl5){\n        let obj3 = {\n          \"id\": '',\n\t\t\t\t\t\"num\":3,//模块一\n\t\t\t\t\t\"sn\": this.num3_sn,//模块一的序列号\n\t\t\t\t\t\"pic\":this.imgurl5//图\n        }\n        module.push(obj3)\n      // }\n      // if(this.num4_sn && this.imgurl6){\n        let obj4 = {\n          \"id\": '',\n\t\t\t\t\t\"num\":4,//模块一\n\t\t\t\t\t\"sn\": this.num4_sn,//模块一的序列号\n\t\t\t\t\t\"pic\":this.imgurl6//图\n        }\n        module.push(obj4)\n      // }\n      let params = {\n        id: \"\",\n        label: this.label_sn,\n        instrument_SN: this.instrument_sn,\n        snpic: this.imgurl2,\n        chassisid: \"\",\n        chassis: this.chassis_sn,\n        chassispic: this.imgurl,\n        module: module,\n        instrument_name: this.instrument_name\n      }\n      console.log('---->:',params)\n\n      if(number == 1){\n        bindinstrument({\n          data: params,\n          status: 1\n        }).then((res) => {\n          if (res.data.success) {\n            Dialog.confirm({\n              title: '标题',\n              message: res.data.msg,\n              cancelButtonText: '返回首页',\n              cancelButtonColor:'#666666',\n              confirmButtonText: '继续绑定',\n              confirmButtonColor: '#307FF5'\n            }).then(() => {\n              that.label_sn= \"\";\n              that.chassis_sn= \"\";\n              that.instrument_sn= \"\";\n              that.num1_sn= \"\";\n              that.num2_sn= \"\";\n              that.num3_sn= \"\";\n              that.num4_sn= \"\";\n              that.numberList= []\n              that.lableLength= 1;\n              that.isShow=false;\n              that.labelIndex= -1;\n              that.imgurl1= \"\";\n              that.imgurl= \"\";\n              that.imgurl2= \"\";\n              that.imgurl3= \"\";\n              that.imgurl4= \"\";\n              that.imgurl5= \"\";\n              that.imgurl6= \"\";\n              that.label_sn_old= \"\";\n              that.chassis_sn_old= \"\";\n              that.instrument_sn_old= \"\";\n              that.num1_sn_old= \"\";\n              that.num2_sn_old= \"\";\n              that.num3_sn_old= \"\";\n              that.num4_sn_old= \"\";\n              that.numberType= \"0\";\n              that.imgurl1_old= \"\";\n              that.imgurl_old= \"\";\n              that.imgurl2_old= \"\";\n              that.imgurl3_old= \"\";\n              that.imgurl4_old= \"\";\n              that.imgurl5_old= \"\";\n              that.imgurl6_old= \"\";\n              that.instrument_name = \"\";\n            }).catch(() => {\n              that.$router.replace({\n                  path: \"/instrumentList\",\n              });\n            });\n          } else {\n            Toast(res.data.msg)\n          }\n        });\n      }else{\n        saveinstrument({\n          data: params,\n          status: 0\n        }).then((res) => {\n          if (res.data.success) {\n            that.isEdit = true;\n            Toast(res.data.msg)\n          } else {\n            Toast(res.data.msg)\n          }\n        });\n      }\n    },\n    ImagePreview(e){\n      let img = e.target.dataset.img;\n      ImagePreview([img]);\n    },\n    canvasDataURL (path, obj, callback) {\n      let img = new Image()\n      img.src = path\n      img.onload = function () {\n        let that = this // 指到img\n        // 默认按比例压缩\n        let w = that.width,\n          h = that.height,\n          scale = w / h\n        w = obj.width || w\n        h = obj.height || (w / scale)\n        w = w >= 4096 ? 4096 : w\n        h = h >= 4096 ? 4096 : h\n        console.log(obj.height,w,h,scale)\n        let quality = 0.5 // 默认图片质量为0.7\n        // 生成canvas\n        let canvas = document.createElement('canvas')\n        let ctx = canvas.getContext('2d')\n        // 创建属性节点\n        let anw = document.createAttribute('width')\n        anw.nodeValue = w\n        let anh = document.createAttribute('height')\n        anh.nodeValue = h\n        canvas.setAttributeNode(anw)\n        canvas.setAttributeNode(anh)\n        ctx.drawImage(that, 0, 0, w, h)\n        // 图像质量\n        if (obj.quality && obj.quality >= 1 && obj.quality < 0) {\n          quality = obj.quality\n        }\n        // quality值越小，所绘制出的图像越模糊\n        let base64 = canvas.toDataURL('image/jpeg', quality)\n        // 回调函数返回base64的值\n        callback(base64)\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n\n\n.icon_logo {\n  width: 40px;\n  height: 40px;\n}\n\n.icon_login_text {\n  font-size: 36px;\n  font-weight: 500;\n  color: #333333;\n}\n\n.bind_main {\n  display: flex;\n  flex-direction: column;\n  // justify-content: center;\n  align-items: center;\n  background: #f5f5f5;\n  // height: 100vh;\n}\n\n.bind_main_item {\n  width: 670px;\n  background: #ffffff;\n  border-radius: 12px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  // align-items: center;\n  margin-top: 40px;\n  padding: 30px;\n\n  .form-item {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    // margin-top: 15px;\n    input {\n      // margin-top: 5px;\n      width: 100%;\n      outline: none;\n      border: none;\n      line-height: 35px;\n      background-color: #eee;\n      border-radius: 5px;\n      padding-left: 0px;\n    }\n    .select-item {\n      display: flex;\n      align-items: center;\n      width: 100%;\n      \n    }\n\n    .input-item {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n\n      input {\n        width: 540px;\n         height: 80px;\n        background: #ffffff;\n        border-radius: 12px;\n        border: none;\n        outline: none;\n        font-size: 28px;\n        font-family: PingFangSC-Regular, PingFang SC;\n        font-weight: 400;\n        color: #999999;\n      }\n\n      .icon_scan {\n        width: 40px;\n        height: 40px;\n      }\n    }\n  }\n}\n\n.submit_view {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  //   margin-top: 20px;\n  width: 90%;\n  height: 88px;\n  background: #307ff5;\n  border-radius: 12px;\n  color: #ffffff;\n  font-size: 32px;\n}\n\n.pic-div {\n  position: relative;\n  width: 40px;\n  height: 40px;\n}\n\n.pic-img-item {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 0px;\n  height: 0px;\n}\n\n.pic-img-icon {\n  position: absolute;\n  width: 40px;\n  height: 40px;\n}\n.pic-img-icon-op {\n  position: absolute;\n  width: 40px;\n  height: 40px;\n  opacity: 0;\n}\n\n.img-item {\n  width: 40px !important;\n  height: 40px !important;\n  background: #eeeeee !important;\n  margin-top: 0px !important;\n  outline: none !important;\n  border: none !important;\n  line-height: 40px !important;\n  padding-left: 0px !important;\n  opacity: 0;\n}\n\n.img_1_view{\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  margin-top: 20px;\n}\n\n.img_1{\n  width: 96px;\n  height: 96px;\n  border-radius: 4px;\n  border: 1px solid #DDDDDD;\n}\n.img_1_text{\n  margin-top: 10px;\n  font-size: 24px;\n  color: #999999;\n}\n\n.empty_view{\n  height: 150px;\n}\n\n.view_bottom {\n  display: flex;\n  justify-content: space-evenly;\n  align-items: center;\n  width: 100%;\n  position: fixed;  \n  bottom: 0px;\n  z-index: 20;\n  height: 120px;\n  background: #FFFFFF;\n}\n\n.view_bottom_left {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 326px;\n  height: 88px;\n  background: #ffffff;\n  border-radius: 12px;\n  border: 1px solid #307ff5;\n  font-size: 34px;\n  color: #307ff5;\n}\n\n.view_bottom_right {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 326px;\n  height: 88px;\n  background: #307ff5;\n  border-radius: 12px;\n  border: 1px solid #307ff5;\n  font-size: 34px;\n  color: #ffffff;\n}\n\n.child-section ::-webkit-scrollbar {display: none;}\n.bind_main {\n        overflow-x: hidden;\n        overflow-y: hidden;\n        /*解决ios上滑动不流畅*/\n        -webkit-overflow-scrolling: touch;\n    }\n\n    .dialog_item{\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      height:80px;\n    }\n\n    .drop-select-item {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      height: 80px;\n      border-bottom: 1px solid #DDDDDD;\n      padding: 20px 0px;\n      position: relative;\n      \n    }\n\n</style>"]}]}